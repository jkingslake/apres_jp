

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Heat equation &#8212; The Glaciology Data Analysis and Modeling book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sections/temperature/heat_equation';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="An analytical solution" href="analytical_solution.html" />
    <link rel="prev" title="Heat flow" href="heat_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../book-intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/thumbnail.png" class="logo__image only-light" alt="The Glaciology Data Analysis and Modeling book - Home"/>
    <script>document.write(`<img src="../../_static/thumbnail.png" class="logo__image only-dark" alt="The Glaciology Data Analysis and Modeling book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../book-intro.html">
                    The Glaciology Data Analysis and Modeling book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Ice flow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/ice-flow-intro.html">Introduction to ice flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/ablation_accumulation.html">Ice flow, accumulation and ablation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/antarctic-ice-flow.html">Flow of the Antarctic Ice sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/vec_calc.html">Vector calculus background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/depth_integrated_mass_balance.html">Depth-integrated mass balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/gradient.html">The gradient of Antarctic Ice Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/strain_velocity.html">Strain rate and velocity fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/rheology.html">Ice rheology (under construction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/stress_strain_tensors.html">Stress and strain tensors (under construction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/deviatoric_stress.html">Deviatoric stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/driving_stress.html">Driving stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/stress_balance_eqns.html">Stress balance equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/sia_derivation.html">The Shallow Ice Approximation model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/u_bar_and_lliboutry.html">Building on the Shallow Ice Approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ice_flow/other-ice-flow-models.html">Two other ice flow models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heat flow</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="heat_intro.html">Heat flow</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Heat equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="analytical_solution.html">An analytical solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical_solutions.html">Numerical solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Radar</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../radar/impulse/impulse-radar.html">Impulse Radar</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../radar/apres/apres-intro.html">Autonomous phase-sensitive Radio Echo Sounder</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../radar/apres/theory_1.html">ApRES theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../radar/apres/beat-frequency.html">Beat frequency</a></li>
<li class="toctree-l2"><a class="reference internal" href="../radar/apres/stacking.html">Stacking ApRES data</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../appendix/upload_Measures_data_to_bucket.html">Adding the MEASURES data to the google bucket</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jkingslake/apres_jp/main?urlpath=lab/tree/src/sections/temperature/heat_equation.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp/edit/main/src/sections/temperature/heat_equation.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp/issues/new?title=Issue%20on%20page%20%2Fsections/temperature/heat_equation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/sections/temperature/heat_equation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Heat equation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advection-and-diffusion">Advection and diffusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deriving-the-heat-equation">Deriving the heat equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advection">Advection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion">Diffusion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bringing-everything-together">Bringing everything together</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-conservation">Mass conservation</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="heat-equation">
<h1>Heat equation<a class="headerlink" href="#heat-equation" title="Permalink to this heading">#</a></h1>
<p>Heat flow, and the corresponding time variation of temperature in ice sheet and glaciers can be described by an advection-diffusion equation, referred to as the heat equation. In cases when melting or freezing is involved is is convenient to instead consider enthalpy (rather than simply heat), but for simiplicity we will initially just consider cases when the ice or snow is below the melting point, so the simpler heat equation is equivelent to an enthalpy formulation.</p>
<p>Below we derive the heat equation from first principles, allowing for temporal and spatial changes in density and velocity. Allowing for these changes results in the same equation that you would reach if you assumed density and velocity constant and uniform, but considering the most general scenario gives us an opportunity to think about the final equation does not depend on if you include them or not.</p>
<section id="setup">
<h2>Setup<a class="headerlink" href="#setup" title="Permalink to this heading">#</a></h2>
<p>We consider a three-dimensional space with cooridinates <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> corresponding respectively to left-right, in and out of the page, and up and down. Glaciologists often use <span class="math notranslate nohighlight">\(x\)</span> to refer to the glacier direction paralell to the large-scale flow and <span class="math notranslate nohighlight">\(y\)</span> to refer to the across flow direction. We define a small box with side lengths <span class="math notranslate nohighlight">\(\delta x\)</span>, <span class="math notranslate nohighlight">\(\delta y\)</span> and <span class="math notranslate nohighlight">\(\delta z\)</span> and volume <span class="math notranslate nohighlight">\(V = \delta x \delta y \delta z\)</span> (<a class="reference internal" href="#fig-heatequationbox"><span class="std std-numref">Fig. 3</span></a>). The box contains firn with a mean temperature <span class="math notranslate nohighlight">\(T\)</span> and a mean density <span class="math notranslate nohighlight">\(\rho\)</span>. The firn/ice is flowing with a 3-D velocity field defined by the vector field <span class="math notranslate nohighlight">\(\vec{u}\)</span>. We ignore the heat content of the air in the pores of the firn and ice.</p>
<div class="admonition-a-note-about-fields admonition">
<p class="admonition-title">A note about fields. </p>
<p>Fields are quantities that are defined at every point in space or time. The air temperature in a room can be defined as a field, with every location in the volume of the room associated with a single value: the temperature. Because temperature is a <em>scalar</em> quantity (it requires only one number to represent it at each point in space or time), this field is called a scalar field.</p>
<p>Vector quantities like velocity, displacement, or force, can also be represented in fields. The only difference is that at each location in space or time a vector field has multiple values associated with to represent its vector quantity. For example, a velocity field has components of velocity corresponding to each direction in the coordinate system. In the case of our 3-D cartesian coordinate system, this means that at each point in space and time the velocity field has separate values representing the component of the velocity in the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> directions. We will denote these separate components using the glaciological convension of <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>, and <span class="math notranslate nohighlight">\(w\)</span> respectively, and we  write <span class="math notranslate nohighlight">\(\vec{u} = (u, v, w)\)</span>. It can be a little confusing that the vector field and its x-component are both represented by u’s, but the arrow over the vector field symbol distinguishes it from the x-component of velocity.</p>
<p>It is important to remember that each component, <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>, and <span class="math notranslate nohighlight">\(w\)</span>, is <em>potentially</em> a function of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>, or <span class="math notranslate nohighlight">\(t\)</span>. In fact, for maximum clarity we could write <span class="math notranslate nohighlight">\(\vec{u}(x,y,z,t) = (u(x,y,z,t), v(x,y,z,t), w(x,y,z,t))\)</span>, although we generally do not. As each velocity component is a function of space and time, we can compute space and time gradients of each quantity individually. For example, the <span class="math notranslate nohighlight">\(x\)</span>-derivative of the <span class="math notranslate nohighlight">\(x\)</span>-component of <span class="math notranslate nohighlight">\(\vec{u}\)</span> would be given by
<span class="math notranslate nohighlight">\( \frac{\partial u}{\partial x} \)</span>
(often called the longitudinal strain rate) or the <span class="math notranslate nohighlight">\(z\)</span>-derivative of the <span class="math notranslate nohighlight">\(z\)</span>-component of <span class="math notranslate nohighlight">\(\vec{u}\)</span> would be given by
<span class="math notranslate nohighlight">\( \frac{\partial w}{\partial z} \)</span>
(referred to as the across-flow vertical shear stress).</p>
</div>
<figure class="align-default" id="fig-heatequationbox">
<a class="reference internal image-reference" href="../../_images/HeatEquationBox.jpg"><img alt="../../_images/HeatEquationBox.jpg" src="../../_images/HeatEquationBox.jpg" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Consider a small cubic region of space of volume <span class="math notranslate nohighlight">\(V\)</span>, filled with firn or ice with a temperature <span class="math notranslate nohighlight">\(T\)</span>, a density <span class="math notranslate nohighlight">\(\rho\)</span>, and a three-dimensional velocity <span class="math notranslate nohighlight">\(\vec{u}\)</span>. The lengths of the sides of the box are <span class="math notranslate nohighlight">\(\delta x\)</span>, <span class="math notranslate nohighlight">\(\delta y\)</span> and <span class="math notranslate nohighlight">\(\delta z\)</span> in the <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> directions respectively.</span><a class="headerlink" href="#fig-heatequationbox" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="advection-and-diffusion">
<h2>Advection and diffusion<a class="headerlink" href="#advection-and-diffusion" title="Permalink to this heading">#</a></h2>
<p>Heat flows due to two processes: advection and diffusion. Noting the fundamental controls on these two processes help us to guess at what our final heat equation is going to look like.</p>
<p>Advection is the transport of heat due to the flowing ice. For example, if the ice upstream of a given location is warmer, ice flow will move this warmer ice into the location in question and contribute to increasing the temperature. Based just on this intuitive picture of advection, you can guess that the rate at which the temperature changes due to this process is proportional to the velocity of the ice and the rate at which <span class="math notranslate nohighlight">\(T\)</span> increases in an upstream direction. The derivation below proves this intuition correct.</p>
<p>Diffusion is the change in heat content in the box due to spatial variation in conduction. Heat flows from warm areas to cold areas through conduction, at a rate proportoinal to the temperature gradient. So, if the temperature gradient is different in different places, mismatches in the rate of heat conduction leads to areas warming up and cooling down. As we are interested in spatial variations in the temperature gradient, you might guess that the ‘gradient of the gradient of’ the temperature will end up being important. This is called the ‘second-derivative’ or ‘ curvature’ of the temperature, and does indeed appear in our final expression.</p>
</section>
<section id="deriving-the-heat-equation">
<h2>Deriving the heat equation<a class="headerlink" href="#deriving-the-heat-equation" title="Permalink to this heading">#</a></h2>
<p>To derive an expression for the rate of change of temperature in this box we equate the rate of change of heat in the box to the rate of heat flow into the box minus the rate of heat flow out of the box. Or, separating the heat flow into contributions from advection and conduction,</p>
<div class="math notranslate nohighlight" id="equation-heat-in-out">
<span class="eqno">(1)<a class="headerlink" href="#equation-heat-in-out" title="Permalink to this equation">#</a></span>\[ 
\frac{\partial H}{\partial t} = A_{in} - A_{out} + C_{in} - C_{out}
\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> is the heat in box, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(C\)</span> are the advective and conductive heat flows and the <em>in</em> and <em>out</em> subscripts denote heat flow in and out. We will also define <span class="math notranslate nohighlight">\(A_{net} = A_{in} - A_{out}\)</span> and <span class="math notranslate nohighlight">\(C_{net} = C_{in} - C_{out}\)</span>.</p>
<p>The heat in the box <span class="math notranslate nohighlight">\(H\)</span> is linearly related to the temperature, the density, the volume on the box and the specific heat capacity of ice, <span class="math notranslate nohighlight">\(c\)</span> 2.0 kJ kg<span class="math notranslate nohighlight">\(^{−1}\)</span> K<span class="math notranslate nohighlight">\(^{−1}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-heat-in-box">
<span class="eqno">(2)<a class="headerlink" href="#equation-heat-in-box" title="Permalink to this equation">#</a></span>\[
H = c V \rho T.
\]</div>
<p>As a first step we differentiate <a class="reference internal" href="#equation-heat-in-box">(2)</a> with respect to <span class="math notranslate nohighlight">\(t\)</span> to expand the left side of <a class="reference internal" href="#equation-heat-in-out">(1)</a>:</p>
<div class="math notranslate nohighlight" id="equation-hdot-expanded">
<span class="eqno">(3)<a class="headerlink" href="#equation-hdot-expanded" title="Permalink to this equation">#</a></span>\[
\frac{\partial H}{\partial t} =  c V \left(\rho \frac{\partial T}{\partial t} + T \frac{\partial \rho}{\partial t}\right). 
\]</div>
<p>Next, we derive expressions for all the terms on the right of <a class="reference internal" href="#equation-heat-in-out">(1)</a>, considering the three direction <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> in turn.</p>
<section id="advection">
<h3>Advection<a class="headerlink" href="#advection" title="Permalink to this heading">#</a></h3>
<p>We focus first on advective heat flow in the <span class="math notranslate nohighlight">\(x\)</span> direction. Heat advected into the box through its left wall per unit time (per second, say) by advection is</p>
<div class="math notranslate nohighlight" id="equation-a-in1">
<span class="eqno">(4)<a class="headerlink" href="#equation-a-in1" title="Permalink to this equation">#</a></span>\[
A^x_{in} = u\, \delta y\, \delta z\, c\, \rho\, T
\]</div>
<p>where the <span class="math notranslate nohighlight">\(x\)</span> superscript denots that this is in the <span class="math notranslate nohighlight">\(x\)</span>-direction only.
To understand this expression, recognize that <span class="math notranslate nohighlight">\(u \delta y \delta z\)</span> is the volume of ice that moves into the box from the left every second (This assumes that the <span class="math notranslate nohighlight">\(x\)</span>-component of the velocity field, <span class="math notranslate nohighlight">\(u\)</span>,  is positive, if <span class="math notranslate nohighlight">\(u\)</span> was negative <span class="math notranslate nohighlight">\(u \delta y \delta z\)</span>  would represent the volume of ice leaving the box, but that’s fine, it would just be a negative heat flux). Also recognize that the heat contained in each cubic meter of ice is given by <span class="math notranslate nohighlight">\(c \rho T\)</span>. Therefore the heat entering every second (from the left) is the product of the volume entering every second (<span class="math notranslate nohighlight">\(u \delta y \delta z\)</span>) and the heat contained in each cubic meter (<span class="math notranslate nohighlight">\(c \rho T\)</span>), which gives <a class="reference internal" href="#equation-a-in1">(4)</a>.</p>
<p>To compute the heat advected out of the box through its right wall per second we remember that <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> are all functions of <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>, and <span class="math notranslate nohighlight">\(t\)</span>. In particular, their <span class="math notranslate nohighlight">\(x\)</span>-dependence is important to us here. We are now considering the right wall of the box, so it is not correct to simply use the same values for <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> as we did above when computing <span class="math notranslate nohighlight">\(A^x_{in}\)</span>. Instead we use a trick, which we use in multiple places in this chapters and others, and say that on the right wall these variables take a value that is equal to their values on the left wall plus a small change which depends on their gradient in the <span class="math notranslate nohighlight">\(x\)</span> direction. As noted above we denote their gradients in the <span class="math notranslate nohighlight">\(x\)</span> direction by <span class="math notranslate nohighlight">\( \frac{\partial u}{\partial x} \)</span>, <span class="math notranslate nohighlight">\( \frac{\partial \rho}{\partial x} \)</span>, and <span class="math notranslate nohighlight">\( \frac{\partial T}{\partial x} \)</span>. These tell us how much these variables changes for every meter that you move in the <span class="math notranslate nohighlight">\(x\)</span> direction. In our case, we are moving a distance of <span class="math notranslate nohighlight">\(\delta x\)</span> from one side of the box to the other, so the total change in each variable relative to its values on the left wall of the box is simply <span class="math notranslate nohighlight">\(\delta x \frac{\partial u}{\partial x} \)</span>, <span class="math notranslate nohighlight">\(\delta x \frac{\partial \rho}{\partial x} \)</span>, and <span class="math notranslate nohighlight">\(\delta x \frac{\partial T}{\partial x} \)</span>.</p>
<p>This allows us to write down an expression for <span class="math notranslate nohighlight">\(A^x_{out}\)</span> by repeating the pattern of {eq}A_in1, but replacing the varibles with modified values that include this small change relative to their values on the left wall:</p>
<div class="math notranslate nohighlight" id="equation-ax-out1">
<span class="eqno">(5)<a class="headerlink" href="#equation-ax-out1" title="Permalink to this equation">#</a></span>\[
A^x_{out} = \left(u + \delta x \frac{\partial u}{\partial x} \right) \delta y \delta z c \left(\rho + \delta x \frac{\partial \rho}{\partial x} \right) \left(T + \delta x \frac{\partial T}{\partial x}\right).
\]</div>
<p>Next we multiple out these brackets to give</p>
<div class="math notranslate nohighlight" id="equation-ax-out2">
<span class="eqno">(6)<a class="headerlink" href="#equation-ax-out2" title="Permalink to this equation">#</a></span>\[
A^x_{out} = \delta y \delta z c \left(u \rho T + \delta x  \frac{\partial u}{\partial x} \rho  T +  \delta x u  \frac{\partial \rho}{\partial x} T +
\delta x u \rho \frac{\partial T}{\partial x} + \delta x^2 \frac{\partial u}{\partial x} \frac{\partial \rho}{\partial x} T  + \delta x^2 \frac{\partial u}{\partial x} \rho  \frac{\partial T}{\partial x}  + 
\delta x^2 u  \frac{\partial \rho}{\partial x} \frac{\partial T}{\partial x}  + \delta x^3 \frac{\partial u}{\partial x} \frac{\partial \rho}{\partial x}  \frac{\partial T}{\partial x} \right)
\]</div>
<p>then omit any terms with <span class="math notranslate nohighlight">\(\delta x\)</span> rasies to a power of 2 or higher, recognizing that <span class="math notranslate nohighlight">\(\delta x\)</span> is already very small so <span class="math notranslate nohighlight">\(\delta x^2\)</span> and <span class="math notranslate nohighlight">\(\delta x^3\)</span> are vanishinglsy small. This leaves</p>
<div class="math notranslate nohighlight" id="equation-ax-out3">
<span class="eqno">(7)<a class="headerlink" href="#equation-ax-out3" title="Permalink to this equation">#</a></span>\[
A^x_{out} = \delta y \delta z c \left(u \rho T + \delta x  \frac{\partial u}{\partial x} \rho  T +  \delta x u  \frac{\partial \rho}{\partial x} T +
\delta x u \rho \frac{\partial T}{\partial x}\right).
\]</div>
<p>At this point it is useful to define <span class="math notranslate nohighlight">\(A^x_{net} = A_{in} - A_{out}\)</span> as the net advective heat flow into the box in the <span class="math notranslate nohighlight">\(x\)</span> direction. Using <a class="reference internal" href="#equation-a-in1">(4)</a> and <a class="reference internal" href="#equation-ax-out3">(7)</a>, <span class="math notranslate nohighlight">\(A^x_{net}\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[
A^x_{net} = -\delta x \delta y \delta z c \left(  \frac{\partial u}{\partial x} \rho  T +   u  \frac{\partial \rho}{\partial x} T +
  u \rho \frac{\partial T}{\partial x}\right)  = - V c \left(  \frac{\partial u}{\partial x} \rho  T +   u  \frac{\partial \rho}{\partial x} T +
  u \rho \frac{\partial T}{\partial x}\right)
\]</div>
<p>Using the product rule on the terms containing derivatives of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(\rho\)</span> yields</p>
<div class="math notranslate nohighlight" id="equation-ax-net">
<span class="eqno">(8)<a class="headerlink" href="#equation-ax-net" title="Permalink to this equation">#</a></span>\[
A^x_{net} = - V c \left(  \frac{\partial \left(u \rho\right)}{\partial x}  T +
  u \rho \frac{\partial T}{\partial x}\right)
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You could simplify this expression further, again using the product rule, to</p>
<div class="math notranslate nohighlight">
\[
A^x_{net} = - V c \left(  \frac{\partial \left(u \rho T\right)}{\partial x} \right)
\]</div>
<p>but leaving it in the form of <a class="reference internal" href="#equation-ax-net">(8)</a> proves useful for an important step later, which uses mass conservation to simplify the expression.</p>
</div>
<p>Equation <a class="reference internal" href="#equation-ax-net">(8)</a> describes the net advection of heat into the box due to two mechansims. The first term in the parentheses is associated with a change in mass in the box. <span class="math notranslate nohighlight">\( u\rho\)</span> is the mass flux in the <span class="math notranslate nohighlight">\(x\)</span> direction. If this quantity, for example, increased in the <span class="math notranslate nohighlight">\(x\)</span> direction, then mass would be leaving the box over time (because mass would be leaving faster through the right wall than it would be entering through the left wall) and this would be represented by <span class="math notranslate nohighlight">\(\frac{\partial u \rho}{\partial x}\)</span> being larger than zero, which, due to the minus sign in <a class="reference internal" href="#equation-ax-net">(8)</a>, contributes to a decrease in the heat in the box. We will see later that this effect is actually exactly balanced by flow in the other directions or temporal changes in <span class="math notranslate nohighlight">\(\rho\)</span>, or both. Therefore, although this term can result in changes in the heat in the box, it does not affect the temperature. We will come back to this point later.</p>
<p>The second term in the parentheses of <a class="reference internal" href="#equation-ax-net">(8)</a> represents advection resulting from the fact that <span class="math notranslate nohighlight">\(T\)</span> can vary with <span class="math notranslate nohighlight">\(x\)</span>. Suppose for example that <span class="math notranslate nohighlight">\(T\)</span> increased with <span class="math notranslate nohighlight">\(x\)</span> and that <span class="math notranslate nohighlight">\(u\)</span> is positive, so there is a component of ice flow along the <span class="math notranslate nohighlight">\(x\)</span> axis in a positive direction. Then ice upstream of our box (at smaller <span class="math notranslate nohighlight">\(x\)</span>) is colder than the ice in the box and this colder ice is being brought into the box by the flow. This contributes to reducing the temperatue in the box and is represented by  <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial x} &gt; 0\)</span> and the minus sign on the right of <a class="reference internal" href="#equation-ax-net">(8)</a>.</p>
<p>Applying exactly the same approach to the advective heat fluxes into and out of the box in the <span class="math notranslate nohighlight">\(y\)</span> direction yields:</p>
<div class="math notranslate nohighlight" id="equation-ay-net">
<span class="eqno">(9)<a class="headerlink" href="#equation-ay-net" title="Permalink to this equation">#</a></span>\[
A^y_{net} = - V c \left(  \frac{\partial \left(v \rho\right)}{\partial y}  T +
  v \rho \frac{\partial T}{\partial y}\right).
\]</div>
<p>And applying it again in <span class="math notranslate nohighlight">\(z\)</span> direction yields</p>
<div class="math notranslate nohighlight" id="equation-az-net">
<span class="eqno">(10)<a class="headerlink" href="#equation-az-net" title="Permalink to this equation">#</a></span>\[
A^z_{net} = - V c \left(  \frac{\partial \left(w \rho\right)}{\partial z}  T +
  w \rho \frac{\partial T}{\partial z}\right).
\]</div>
<p>Summing <a class="reference internal" href="#equation-ax-net">(8)</a>, <a class="reference internal" href="#equation-ay-net">(9)</a>, <a class="reference internal" href="#equation-az-net">(10)</a> yields an expression for net advective flow</p>
<div class="math notranslate nohighlight" id="equation-a-net">
<span class="eqno">(11)<a class="headerlink" href="#equation-a-net" title="Permalink to this equation">#</a></span>\[
A_{net} = - V c \left[ \left(  \frac{\partial \left(u \rho\right)}{\partial x}  T +
  u \rho \frac{\partial T}{\partial x}\right) 
  + \left(  \frac{\partial \left(v \rho\right)}{\partial y}  T +
  v \rho \frac{\partial T}{\partial y}\right)
  + \left(  \frac{\partial \left(w \rho\right)}{\partial z}  T +
  w \rho \frac{\partial T}{\partial z}\right)  \right] 
\]</div>
</section>
<section id="diffusion">
<h3>Diffusion<a class="headerlink" href="#diffusion" title="Permalink to this heading">#</a></h3>
<p>Diffusion of heat is due to spatial gradients in the heat flux due to conduction. In other words, if heat is being conducted through one wall of the box at a different rate than it is being conducted on through the opposite wall, this will contribute to a change in the heat in the box.</p>
<p>Heat conduction is described by <a class="reference external" href="https://en.wikipedia.org/wiki/Thermal_conduction#Fourier's_law">Fouriers law</a> of thermal conduction. Applying it in the <span class="math notranslate nohighlight">\(x\)</span> direction gives</p>
<div class="math notranslate nohighlight" id="equation-q-x">
<span class="eqno">(12)<a class="headerlink" href="#equation-q-x" title="Permalink to this equation">#</a></span>\[
q_x = -K\frac{\partial T}{\partial x},
\]</div>
<p>where <span class="math notranslate nohighlight">\(q_x\)</span> is the heat flux in every square meter of cross-sectional area measured perpendicular to the <span class="math notranslate nohighlight">\(x\)</span> axis. The heat conducted into the box through the left wall is therefore</p>
<div class="math notranslate nohighlight">
\[
C^x_{in} = -\delta y \delta z K\frac{\partial T}{\partial x}.
\]</div>
<p>Because <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial x}\)</span> are functions of <span class="math notranslate nohighlight">\(x\)</span>, conduction out of the box through the right wall can be written as</p>
<div class="math notranslate nohighlight">
\[
C^x_{out} = -\left(\delta y \delta zK\frac{\partial T}{\partial x} 
+ \delta x \frac{\partial}{\partial x} \left( \delta y \delta z K \frac{\partial T}{\partial x}  \right)  \right).
\]</div>
<p>The net conductive heat flow along hte <span class="math notranslate nohighlight">\(x\)</span> axis is therefore</p>
<div class="math notranslate nohighlight">
\[
C^x_{net} = C^x_{in} - C^x_{out} = \delta x \delta y \delta z \frac{\partial}{\partial x} \left( K \frac{\partial T}{\partial x}  \right) = V \frac{\partial}{\partial x} \left( K \frac{\partial T}{\partial x}  \right)
\]</div>
<p>As expected, the second derivative (or ‘curvature’) of the temperature appears in this expression. This can be understood by considering the case when <span class="math notranslate nohighlight">\(K(x) = K\)</span> (i.e. <span class="math notranslate nohighlight">\(K\)</span> is not a function of <span class="math notranslate nohighlight">\(x\)</span>) and therefore</p>
<div class="math notranslate nohighlight" id="equation-c-x-net">
<span class="eqno">(13)<a class="headerlink" href="#equation-c-x-net" title="Permalink to this equation">#</a></span>\[
C^x_{net} \propto \frac{\partial^2 T}{\partial x^2}.
\]</div>
<figure class="align-default" id="fig-t-minimum">
<a class="reference internal image-reference" href="../../_images/T_minimum.jpg"><img alt="../../_images/T_minimum.jpg" src="../../_images/T_minimum.jpg" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Schematic of the variation of <span class="math notranslate nohighlight">\(T\)</span> with <span class="math notranslate nohighlight">\(x\)</span> in the region of a minimum in <span class="math notranslate nohighlight">\(T\)</span>. As indicated on the plot, the gradient of <span class="math notranslate nohighlight">\(T\)</span> is negative to the left and positive to the right of the minimum. This causes heat to flow towards the minimum, as indicated by the large red arrows.</span><a class="headerlink" href="#fig-t-minimum" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Consider a location with a local minimum in <span class="math notranslate nohighlight">\(T\)</span> (<a class="reference internal" href="#fig-t-minimum"><span class="std std-numref">Fig. 4</span></a>). Immediately to the left of this location <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial x} &lt; 0\)</span>. Immediately to the right, <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial x} &gt; 0\)</span>  -  <span class="math notranslate nohighlight">\(\frac{\partial T}{\partial x}\)</span> is increasing with <span class="math notranslate nohighlight">\(x\)</span>. In other words,  <span class="math notranslate nohighlight">\(\frac{\partial^2 T}{\partial x^2} &gt; 0\)</span>, so according to <a class="reference internal" href="#equation-c-x-net">(13)</a> this process contributes to an increase in heat in this location, reducing the depth of the minima. This makes sense because we are at a minimum in <span class="math notranslate nohighlight">\(T\)</span>, so in both directions higher <span class="math notranslate nohighlight">\(T\)</span> causes heat to be conducted towards this minimum. The same argument applies, not just at minima (or in reverse at maxima) in <span class="math notranslate nohighlight">\(T\)</span>, but anywhere with curvature in <span class="math notranslate nohighlight">\(T\)</span>: its all down to the gradient in <span class="math notranslate nohighlight">\(T\)</span> being different on side of a given location than it is on the other side, so that the <em>net</em> contribution of conduction is to either increase or decrease tempeature.</p>
<p>Applying the same approach outlined above to in the <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> directions gives us</p>
<div class="math notranslate nohighlight" id="equation-c-y-net">
<span class="eqno">(14)<a class="headerlink" href="#equation-c-y-net" title="Permalink to this equation">#</a></span>\[
C^y_{net}= V \frac{\partial}{\partial y} \left( K \frac{\partial T}{\partial y}  \right)
\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-c-z-net">
<span class="eqno">(15)<a class="headerlink" href="#equation-c-z-net" title="Permalink to this equation">#</a></span>\[
C^z_{net} = V \frac{\partial}{\partial z} \left( K \frac{\partial T}{\partial z}  \right)
\]</div>
</section>
<section id="bringing-everything-together">
<h3>Bringing everything together<a class="headerlink" href="#bringing-everything-together" title="Permalink to this heading">#</a></h3>
<p>Bringing together expressions for the net advective flow, <span class="math notranslate nohighlight">\(A_{net}\)</span> (<a class="reference internal" href="#equation-a-net">(11)</a>), the net conductive heat flows in each direction, (<a class="reference internal" href="#equation-c-x-net">(13)</a>, <a class="reference internal" href="#equation-c-y-net">(14)</a>, <a class="reference internal" href="#equation-c-z-net">(15)</a>), and the rate of change of heat in the box (<a class="reference internal" href="#equation-hdot-expanded">(3)</a>) gives us</p>
<div class="math notranslate nohighlight" id="equation-heat-eq-full-1">
<span class="eqno">(16)<a class="headerlink" href="#equation-heat-eq-full-1" title="Permalink to this equation">#</a></span>\[
c  \left(\rho \frac{\partial T}{\partial t} + T \frac{\partial \rho}{\partial t}\right)= 
  -  c \left[ \left(  \frac{\partial \left(u \rho\right)}{\partial x}  T 
  + u \rho \frac{\partial T}{\partial x}\right) 
  + \left(  \frac{\partial \left(v \rho\right)}{\partial y}  T 
  + v \rho \frac{\partial T}{\partial y}\right)
  + \left(  \frac{\partial \left(w \rho\right)}{\partial z}  T 
  + w \rho \frac{\partial T}{\partial z}\right)  \right]
  +  \frac{\partial}{\partial x} \left( K \frac{\partial T}{\partial x}  \right)
  +  \frac{\partial}{\partial y} \left( K \frac{\partial T}{\partial y}  \right)
  +  \frac{\partial}{\partial z} \left( K \frac{\partial T}{\partial z}  \right)
\]</div>
<p>Notice that the volume of the box <span class="math notranslate nohighlight">\(V\)</span> has cancelled from both sides of this expression. Let’s think about what this cancelling of <span class="math notranslate nohighlight">\(V\)</span> really means. <span class="math notranslate nohighlight">\(V\)</span> appeared on the left of this expression because it takes more heat to increase the temperature of a larger box than a smaller box. <span class="math notranslate nohighlight">\(V\)</span> appeared on the right of this expression because all the heat fluxes into and out of the box for given <span class="math notranslate nohighlight">\(T\)</span>, <span class="math notranslate nohighlight">\(\vec{u}\)</span> and <span class="math notranslate nohighlight">\(\rho\)</span> fields, are larger for a larger box than a smaller one because the walls are larger. This explains what <span class="math notranslate nohighlight">\(V\)</span> cancelling means: It takes more heat to change the temperature of a larger box, but a larger box <em>gets</em> more heat from set of conditions. It also makes a lot of sense that <span class="math notranslate nohighlight">\(V\)</span> should cancel because the size and shape this box was chosen arbitrarily and for convenience and should not appear in our final result. In fact, the expression above is very close to our final result. However, there is one interesting simplification that remains to be made.</p>
</section>
<section id="mass-conservation">
<h3>Mass conservation<a class="headerlink" href="#mass-conservation" title="Permalink to this heading">#</a></h3>
<p>To apply the principle of mass conservation to our box, we will apply the same approach as we did above. We define the mass in the box as <span class="math notranslate nohighlight">\(M = V \rho\)</span>, and differentiate to get</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial M}{\partial t} = V \frac{\partial \rho}{\partial t}.
\]</div>
<p>Note the <span class="math notranslate nohighlight">\(V\)</span> is constant in time so it is unaffected by the differentiation. We equate this to the net rate of mass flow it to the box through the walls.</p>
<div class="math notranslate nohighlight" id="equation-m-net">
<span class="eqno">(17)<a class="headerlink" href="#equation-m-net" title="Permalink to this equation">#</a></span>\[
V \frac{\partial \rho}{\partial t} = M_{net}.
\]</div>
<p>Next we write down expressions for the rate of mass flow in and out through each wall of the box, considering each direction in turn. The mass flowing in through the left wall in the <span class="math notranslate nohighlight">\(x\)</span> direction is</p>
<div class="math notranslate nohighlight">
\[ 
M^x_{in} = \delta y \delta z \rho u 
\]</div>
<p>and the mass flowing  out through the right wall is</p>
<div class="math notranslate nohighlight">
\[
M^x_{out} = \delta y \delta z \left(\rho u + \delta x \frac{\partial \left(u \rho \right)}{\partial x}\right).
\]</div>
<p>Therefore the net mass flow in this direction is</p>
<div class="math notranslate nohighlight">
\[
M^x_{net} =  M^x_{in} - M^x_{out} = -\delta y \delta z \delta x \frac{\partial \left(u \rho \right)}{\partial x}  = -V \frac{\partial \left(u\rho \right)}{\partial x}.
\]</div>
<p>Applying the same approach in the other directions and combining the results with the expression above gives us the net rate of mass input to the box,</p>
<div class="math notranslate nohighlight">
\[
M_{net} =  -V \left(\frac{\partial \left(u \rho \right)}{\partial x} + \frac{\partial \left(v \rho \right)}{\partial y} + \frac{\partial \left(w\rho \right)}{\partial z} \right).
\]</div>
<p>which we can combine with <a class="reference internal" href="#equation-m-net">(17)</a> to give</p>
<div class="math notranslate nohighlight" id="equation-mass-con">
<span class="eqno">(18)<a class="headerlink" href="#equation-mass-con" title="Permalink to this equation">#</a></span>\[
\frac{\partial \rho}{\partial t} = - \left(\frac{\partial \left(u\rho \right)}{\partial x} + \frac{\partial \left(v\rho \right)}{\partial y} + \frac{\partial \left(w \rho \right)}{\partial z} \right)
\]</div>
<p>This is a general statement of mass conservation. It says that the flux divergence is the negative of densification. For those familiar with the notation, it can be expressed more compactly as</p>
<div class="math notranslate nohighlight">
\[
\dot{\rho} = \vec{\nabla} \cdot \vec{q}
\]</div>
<p>where <span class="math notranslate nohighlight">\(\vec{q} \)</span> is the flux, <span class="math notranslate nohighlight">\( \vec{q}= \vec{u} \rho\)</span>, and <span class="math notranslate nohighlight">\(\vec{\nabla}\)</span> is the del operator, <span class="math notranslate nohighlight">\(\vec{\nabla} = \vec{i}\frac{\partial }{\partial x}  + \vec{j} \frac{\partial }{\partial y}+  \vec{k}\frac{\partial }{\partial z}. \)</span></p>
<p>Equation <a class="reference internal" href="#equation-mass-con">(18)</a> can be understood by considering a simply scenario where <span class="math notranslate nohighlight">\(\rho\)</span> is uniform in space but can change in time, and ice flow is along the <span class="math notranslate nohighlight">\(z\)</span> axis, <span class="math notranslate nohighlight">\(\vec{u} = w\)</span>. Under these conditions <a class="reference internal" href="#equation-mass-con">(18)</a> reduces to</p>
<div class="math notranslate nohighlight" id="equation-m-z">
<span class="eqno">(19)<a class="headerlink" href="#equation-m-z" title="Permalink to this equation">#</a></span>\[
\frac{\partial \rho}{\partial t} = - \rho \frac{\partial w }{\partial z} 
\]</div>
<p>Consider the case when <span class="math notranslate nohighlight">\(w\)</span> increases with <span class="math notranslate nohighlight">\(w\)</span>. The ice above any given location is flowing faster than the ice below, leading to vertical stretching. As expected, according to <a class="reference internal" href="#equation-m-z">(19)</a>, stretching is associated with a reduction in density. The reverse is also intuitive. If <span class="math notranslate nohighlight">\(w\)</span> decreases with <span class="math notranslate nohighlight">\(x\)</span>, ice above any given location is flowing faster than the ice below, leading to vertical compression. It makes sense that, <a class="reference internal" href="#equation-m-z">(19)</a> says this is  is associated with densification. In fact, this is a common situation in the relatively low density, near-surface layer of the ice sheets called firn.</p>
<p>Substituting in <a class="reference internal" href="#equation-mass-con">(18)</a> to <a class="reference internal" href="#equation-heat-eq-full-1">(16)</a> gives us</p>
<div class="math notranslate nohighlight" id="equation-heat-eq-full-final">
<span class="eqno">(20)<a class="headerlink" href="#equation-heat-eq-full-final" title="Permalink to this equation">#</a></span>\[
\frac{\partial T}{\partial t} = 
-   u  \frac{\partial T}{\partial x}
- v  \frac{\partial T}{\partial y}
-  w  \frac{\partial T}{\partial z}  
+  \frac{1}{c \rho}\left[\frac{\partial}{\partial x} \left( K \frac{\partial T}{\partial x}  \right)
  +  \frac{\partial}{\partial y} \left( K \frac{\partial T}{\partial y}  \right)
  +  \frac{\partial}{\partial z} \left( K \frac{\partial T}{\partial z}  \right)\right]
\]</div>
<p>Again, for those familiar with the notation, a more compact way to write this is with the del operator:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial T}{\partial t} = -\vec{u} \cdot \vec{\nabla}T
+  \frac{1}{c \rho} \vec{\nabla} \cdot K \vec{\nabla}T.
\]</div>
<p>Let’s note what happened here: the tern on the right of <a class="reference internal" href="#equation-heat-eq-full-1">(16)</a>, <span class="math notranslate nohighlight">\( c T \frac{\partial \rho}{\partial t}\)</span>, representing the heat density, i.e. how much heat is in each cubic meter, cancelled with the three flux diveregence terms on the right (<span class="math notranslate nohighlight">\(c T \frac{\partial \left(u\rho \right)}{\partial x}\)</span> etc.). This shows us that while these divergence terms can change the ammount of heat in the box, they cannot change the temperature because the density in the box changes to counterbalance any change in the heat content. For example, suppose that spatial gradients in flux caused the heat content in the box to double. At the same time, the density in the box would also double, meaning that the ice requires double the heat to maintain the same temperatue as it had before the change.</p>
<p>Equation <a class="reference internal" href="#equation-heat-eq-full-final">(20)</a> is our final complete form of the heat equation that we will analyze in the following pages.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jkingslake/apres_jp",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./sections/temperature"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="heat_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Heat flow</p>
      </div>
    </a>
    <a class="right-next"
       href="analytical_solution.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">An analytical solution</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#setup">Setup</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#advection-and-diffusion">Advection and diffusion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#deriving-the-heat-equation">Deriving the heat equation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advection">Advection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diffusion">Diffusion</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bringing-everything-together">Bringing everything together</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-conservation">Mass conservation</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>