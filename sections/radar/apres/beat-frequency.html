

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Beat frequency &#8212; The Glaciology Data Analysis and Modeling book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sections/radar/apres/beat-frequency';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Stacking ApRES data" href="stacking.html" />
    <link rel="prev" title="ApRES theory" href="theory_1.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../book-intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/thumbnail.png" class="logo__image only-light" alt="The Glaciology Data Analysis and Modeling book - Home"/>
    <script>document.write(`<img src="../../../_static/thumbnail.png" class="logo__image only-dark" alt="The Glaciology Data Analysis and Modeling book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../book-intro.html">
                    The Glaciology Data Analysis and Modeling book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Ice flow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/ice-flow-intro.html">Introduction to ice flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/ablation_accumulation.html">Ice flow, accumulation and ablation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/antarctic-ice-flow.html">Flow of the Antarctic Ice sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/vec_calc.html">Vector calculus background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/depth_integrated_mass_balance.html">Depth-integrated mass balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/gradient.html">The gradient of Antarctic Ice Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/strain_velocity.html">Strain rate and velocity fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/rheology.html">Ice rheology (under construction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/stress_strain_tensors.html">Stress and strain tensors (under construction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/deviatoric_stress.html">Deviatoric stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/driving_stress.html">Driving stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/stress_balance_eqns.html">Stress balance equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/sia_derivation.html">The Shallow Ice Approximation model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/u_bar_and_lliboutry.html">Building on the Shallow Ice Approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/other-ice-flow-models.html">Two other ice flow models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heat flow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../temperature/heat_intro.html">Heat flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../temperature/heat_equation.html">Heat equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../temperature/analytical_solution.html">An analytical solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../temperature/numerical_solutions.html">Numerical solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Radar</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../impulse/impulse-radar.html">Impulse Radar</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="apres-intro.html">Autonomous phase-sensitive Radio Echo Sounder</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="theory_1.html">ApRES theory</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Beat frequency</a></li>
<li class="toctree-l2"><a class="reference internal" href="stacking.html">Stacking ApRES data</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../appendix/upload_Measures_data_to_bucket.html">Adding the MEASURES data to the google bucket</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jkingslake/apres_jp/main?urlpath=lab/tree/src/sections/radar/apres/beat-frequency.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp/edit/main/src/sections/radar/apres/beat-frequency.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp/issues/new?title=Issue%20on%20page%20%2Fsections/radar/apres/beat-frequency.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/sections/radar/apres/beat-frequency.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Beat frequency</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-addition-of-waves">Numerical addition of waves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trignometry-tells-us-the-frequencies">Trignometry tells us the frequencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-theoretical-and-numerical-predictions">Compare the theoretical and numerical predictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-to-isolate-the-beat-frequency">Filtering to isolate the beat frequency</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="beat-frequency">
<span id="page-beat-frequency"></span><h1>Beat frequency<a class="headerlink" href="#beat-frequency" title="Permalink to this heading">#</a></h1>
<p>The Autonomous phase-sensitive Radio-Echo Sounder (ApRES) uses the concept of <em>beat frequency</em> to compute the difference in the frequency between a transmitted signal and a received signal. From this frequency, the range to each englacial reflector can be calculated (see <a class="reference internal" href="theory_1.html#page-apres-theory"><span class="std std-ref">here</span></a>).</p>
<p>Beat freqencies occur when two waves with different frequencies are superimposed, producing a third wave that is the sum of the two original waves. Because the two waves have different frequencies, they gradually shift out of and into phase with one another as time goes by. Where they are in phase they interfere constructively and where they are out of phase they interfere destructively. So, as they shift in and out of phase the resulting wave increases and descreases in amplitude. This occurs at a particular frequency: the beat frequency.</p>
<p>Below we explore this numerically and theoretically.</p>
<section id="numerical-addition-of-waves">
<h2>Numerical addition of waves<a class="headerlink" href="#numerical-addition-of-waves" title="Permalink to this heading">#</a></h2>
<p>Let’s start by getting a feel for what we expect to see by superimposing two waves numerically.
We will define two waves <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span> by
<span class="math notranslate nohighlight">\(
s_1 = A_1 \sin \left(\omega_1 t\right)
\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(
s_2 = A_2 \sin \left(\omega_2 t\right).
\)</span></p>
<p>Their amplitudes are <span class="math notranslate nohighlight">\(A_1\)</span> and <span class="math notranslate nohighlight">\(A_2\)</span>, and their <em>angular frequencies</em> are <span class="math notranslate nohighlight">\(\omega_1\)</span> and <span class="math notranslate nohighlight">\(\omega_2\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Angular frequencies <span class="math notranslate nohighlight">\(\omega\)</span> tell us how fast the phase of a wave increaes with time. The units of <span class="math notranslate nohighlight">\(\omega\)</span> are radians per second. Angular frequency is related to <em>frequency</em> <span class="math notranslate nohighlight">\(f\)</span> by <span class="math notranslate nohighlight">\(\omega = 2\pi f\)</span>.</p>
</div>
<p>We start by loading two python packages, Numpy and Matplotlib. <a class="reference external" href="https://numpy.org/">Numpy</a> is for doing calculations with arrays. <a class="reference external" href="https://matplotlib.org/">Matplotlib</a> is for plotting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>Next let’s define <span class="math notranslate nohighlight">\(\pi\)</span> and a time vector which runs from <span class="math notranslate nohighlight">\(t=0\)</span> seconds to <span class="math notranslate nohighlight">\(t=40\pi\)</span> seconds and has 1000 elements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>                                <span class="c1"># define pi</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">40</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>     <span class="c1"># define a time vector </span>
</pre></div>
</div>
</div>
</div>
<p>Next we define a function which we will use to create our waves. It will take as input the desired amplitude and the desired angular frequency.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">wave</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">omega</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">A</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can use this function to define two waves with two slightly different frequencies of 2 and 1.8 rad s<span class="math notranslate nohighlight">\(^{-1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega1</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">A1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">wave</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span><span class="n">omega1</span><span class="p">)</span>

<span class="n">omega1</span> <span class="o">=</span> <span class="mf">1.8</span>
<span class="n">A2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">wave</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span><span class="n">omega1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>When we plot both waves against time we can see how <span class="math notranslate nohighlight">\(s_1\)</span>, with its slightly lower frequency, (in blue below) starts to lag behind <span class="math notranslate nohighlight">\(s_2\)</span> (in orange) after only one cycle. By <span class="math notranslate nohighlight">\(t\approx 15\)</span> s they are in anti-phase, and by <span class="math notranslate nohighlight">\(t\approx 30\)</span> s they are back in phase again. This shifting in and out of phase repeats regularly across the plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">s2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;our two waves&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time, $t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$s_1$&#39;</span><span class="p">,</span><span class="s1">&#39;$s_2$&#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e3b95699ffe53e40cd8e4d133eeb5f1ace0a7cb87191548bb6e40a360256533f.png" src="../../../_images/e3b95699ffe53e40cd8e4d133eeb5f1ace0a7cb87191548bb6e40a360256533f.png" />
</div>
</div>
<p>To see how this affects the sum of the two waves we will plot <span class="math notranslate nohighlight">\(s_1+s_2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$s_1 + s_2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$s_1+s_2$&#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/4eae32bfb2e16d25cd8b0baf76721f81c7ff1f86ed98c97533278b764e5cf3c4.png" src="../../../_images/4eae32bfb2e16d25cd8b0baf76721f81c7ff1f86ed98c97533278b764e5cf3c4.png" />
</div>
</div>
<p>As we discussed at the top of this page, where the two waves are in phase, summing them causes constructive interference and we get waves with amplitudes of <span class="math notranslate nohighlight">\(A_1+A_2 = 1\)</span>. Similarly, where they are in antiphase they interfer destructively and the waves are much smaller, instanteously reaching zero amplitude at <span class="math notranslate nohighlight">\(t\approx\)</span> 15, 50, etc. In other words, it appears that this new signal (<span class="math notranslate nohighlight">\(s_1 + s_2\)</span>) consists of relatively high frequency waves with a uniform frequency similar to the frequency of <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span>, which are modulated by a lower frequency repeating signal.</p>
</section>
<section id="trignometry-tells-us-the-frequencies">
<h2>Trignometry tells us the frequencies<a class="headerlink" href="#trignometry-tells-us-the-frequencies" title="Permalink to this heading">#</a></h2>
<p>It turns out that some trignometry shows that this lower frequency signal is the difference between the two signals - exactly what we need for estimating the range to reflectors with ApRES.</p>
<p>Assume, as we did above, that the amplitudes of the waves are the same (<span class="math notranslate nohighlight">\(A_1 = A_2\)</span>). Summing two well known trignometric identities</p>
<p><span class="math notranslate nohighlight">\(
\sin(\alpha+\beta) = \sin(\alpha)\cos(\beta) + \cos(\alpha)\sin(\beta)
\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(
\sin(\alpha-\beta) = \sin(\alpha)\cos(\beta) - \cos(\alpha)\sin(\beta),  
\)</span></p>
<p>gives</p>
<p><span class="math notranslate nohighlight">\(
\frac{1}{2}[\sin(\alpha+\beta)+\sin(\alpha-\beta)] = \sin(\alpha)\cos(\beta).
\)</span></p>
<p>Then we substitute in <span class="math notranslate nohighlight">\(u = \alpha+\beta\)</span> and <span class="math notranslate nohighlight">\(v = \alpha-\beta\)</span> to get</p>
<p><span class="math notranslate nohighlight">\(
\frac{1}{2}[\sin(u)+\sin(v)] = \sin(\alpha)\cos(\beta).
\)</span></p>
<p>Then, recongizing that <span class="math notranslate nohighlight">\(u + v = 2\alpha\)</span> and <span class="math notranslate nohighlight">\(u - v = 2\beta\)</span>, we find</p>
<p><span class="math notranslate nohighlight">\(
\frac{1}{2}[\sin(u)+\sin(v)] = \sin\left(\frac{u + v}{2}\right)\cos\left(\frac{u - v}{2}\right).
\)</span></p>
<p>This is one of the so-called <em>sum-to-product</em> trignometric identities. Finally, subsituting in <span class="math notranslate nohighlight">\(u = \omega_1 t\)</span> and <span class="math notranslate nohighlight">\(v = \omega_2 t\)</span> provides our answer:</p>
<p><span class="math notranslate nohighlight">\(
\sin(\omega_1 t)+\sin(\omega_2 t) = 2\sin\left(\frac{\omega_1  + \omega_2}{2}t\right)\cos\left(\frac{\omega_1  - \omega_2 }{2}t\right).
\)</span></p>
<p>The frequencies of the two components of the function (<span class="math notranslate nohighlight">\(s_1+s_2\)</span>) plotted above are (1) the average of frequencies of the two waves, and (2) half the difference between the frequencies.</p>
</section>
<section id="compare-the-theoretical-and-numerical-predictions">
<h2>Compare the theoretical and numerical predictions<a class="headerlink" href="#compare-the-theoretical-and-numerical-predictions" title="Permalink to this heading">#</a></h2>
<p>To demonstrate this, let’s plot the two components and their sum and compare them to the plot above. For clarity, let’s first define</p>
<p><span class="math notranslate nohighlight">\(
g_1 = \sin\left(\frac{\omega_1 t + \omega_2 t}{2}\right)
\)</span></p>
<p>and</p>
<p><span class="math notranslate nohighlight">\(
g_2 = \cos\left(\frac{\omega_1 t - \omega_2 t}{2}\right).
\)</span></p>
<p>Then plot these two functions against time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we will use our function &#39;wave&#39; again when we can</span>
<span class="n">g1</span> <span class="o">=</span> <span class="n">wave</span><span class="p">(</span><span class="n">A1</span><span class="p">,(</span><span class="n">omega_1</span> <span class="o">+</span> <span class="n">omega_2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">g2</span> <span class="o">=</span> <span class="n">A2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">omega_1</span> <span class="o">-</span> <span class="n">omega_2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">g1</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">g2</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$g_1$ and $g_2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$g_1$&#39;</span><span class="p">,</span><span class="s1">&#39;$g_2$&#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1"># we will use our function &#39;wave&#39; again when we can</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">g1</span> <span class="o">=</span> <span class="n">wave</span><span class="p">(</span><span class="n">A1</span><span class="p">,(</span><span class="n">omega_1</span> <span class="o">+</span> <span class="n">omega_2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">g2</span> <span class="o">=</span> <span class="n">A2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="n">omega_1</span> <span class="o">-</span> <span class="n">omega_2</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;omega_1&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This looks promising. But to really compare this to the green plot above (<span class="math notranslate nohighlight">\(s_1 + s_2\)</span>) we need to plot <span class="math notranslate nohighlight">\(2g_1 g_2\)</span>, as follows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">g1</span><span class="o">*</span><span class="n">g2</span><span class="p">,</span><span class="s1">&#39;k--&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">s1</span><span class="o">+</span><span class="n">s2</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$g_1 g_2$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;$2 g_1 g_2$&#39;</span><span class="p">,</span><span class="s1">&#39;$s1+s2$&#39;</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$t$ [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0e0d424f07c60c0358c1925c7d16a1b5e2ae9fda81354e7f2ce2d2ec45a80755.png" src="../../../_images/0e0d424f07c60c0358c1925c7d16a1b5e2ae9fda81354e7f2ce2d2ec45a80755.png" />
</div>
</div>
<p>As expected, the lower frequency signal, <span class="math notranslate nohighlight">\(g_2\)</span>, modulates the higher frequency signal, <span class="math notranslate nohighlight">\(g_1\)</span>. Note that the increase and decrease in amplitude occurs where <span class="math notranslate nohighlight">\(g_2 &gt; 0\)</span> or <span class="math notranslate nohighlight">\(g_2&lt;0\)</span>, so the modulation has a frequency of <span class="math notranslate nohighlight">\(2g_2\)</span>, i.e. <span class="math notranslate nohighlight">\(\omega_1 - \omega_2\)</span>. This is called the beat frequency.</p>
</section>
<section id="filtering-to-isolate-the-beat-frequency">
<h2>Filtering to isolate the beat frequency<a class="headerlink" href="#filtering-to-isolate-the-beat-frequency" title="Permalink to this heading">#</a></h2>
<p>Throughout each chirp, ApRES continuously sums the received and transmitted signals, producing a signal with high frequency components corresponding to <span class="math notranslate nohighlight">\(g_1\)</span> and low frequency components corresponding to <span class="math notranslate nohighlight">\(g_2 = \omega_2 - \omega_1\)</span>, the beat frequency, which is the component used to compute the range to reflectors. The high frequency component is in the megahertz range and the low frequency component is in the kilohertz range. To isolate the low frequnecy component, the radar passes the signal through a low-pass filter. The response is shown in <a class="reference internal" href="#fig-active-filter-apres"><span class="std std-numref">Fig. 5</span></a>.</p>
<figure class="align-default" id="fig-active-filter-apres">
<a class="reference internal image-reference" href="../../../_images/active-filter-ApRES.png"><img alt="../../../_images/active-filter-ApRES.png" src="../../../_images/active-filter-ApRES.png" style="height: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">The frequency response of the active filter in ApRES. From a slide show that can be found <a class="reference external" href="https://github.com/ldeo-glaciology/phase-sensitive-radar-processing/blob/5cce6bd838cb70e290316195af9ceefe3d4a52ee/other%20documents/ApRES%20Tutorial.pdf">here</a>.</span><a class="headerlink" href="#fig-active-filter-apres" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>As well as isolating the kHz component of the signal, this filter preferentially amplifies higher frequencies in the kHz range to amplify distant targets.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jkingslake/apres_jp",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./sections/radar/apres"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="theory_1.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">ApRES theory</p>
      </div>
    </a>
    <a class="right-next"
       href="stacking.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Stacking ApRES data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-addition-of-waves">Numerical addition of waves</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#trignometry-tells-us-the-frequencies">Trignometry tells us the frequencies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compare-the-theoretical-and-numerical-predictions">Compare the theoretical and numerical predictions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering-to-isolate-the-beat-frequency">Filtering to isolate the beat frequency</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>