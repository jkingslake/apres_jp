

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>A first look at ApRES data &#8212; The Glaciology Data Analysis and Modeling book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sections/radar/apres/apres_data_1';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Adding the MEASURES data to the google bucket" href="../../appendix/upload_Measures_data_to_bucket.html" />
    <link rel="prev" title="Beat frequency" href="beat-frequency.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../book-intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/thumbnail.png" class="logo__image only-light" alt="The Glaciology Data Analysis and Modeling book - Home"/>
    <script>document.write(`<img src="../../../_static/thumbnail.png" class="logo__image only-dark" alt="The Glaciology Data Analysis and Modeling book - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../book-intro.html">
                    The Glaciology Data Analysis and Modeling book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Ice flow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/ice-flow-intro.html">Introduction to ice flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/ablation_accumulation.html">Ice flow, accumulation and ablation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/antarctic-ice-flow.html">Flow of the Antarctic Ice sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/vec_calc.html">Vector calculus background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/depth_integrated_mass_balance.html">Depth-integrated mass balance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/gradient.html">The gradient of Antarctic Ice Sheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/strain_velocity.html">Strain rate and velocity fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/rheology.html">Ice rheology (under construction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/stress_strain_tensors.html">Stress and strain tensors (under construction)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/deviatoric_stress.html">Deviatoric stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/driving_stress.html">Driving stress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/stress_balance_eqns.html">Stress balance equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/sia_derivation.html">The Shallow Ice Approximation model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/u_bar_and_lliboutry.html">Building on the Shallow Ice Approximation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ice_flow/other-ice-flow-models.html">Two other ice flow models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Heat flow</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../temperature/heat_intro.html">Heat flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../temperature/heat_equation.html">Heat equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../temperature/analytical_solution.html">An analytical solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../temperature/numerical_solutions.html">Numerical solutions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Radar</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../impulse/impulse-radar.html">Impulse Radar</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="apres-intro.html">Autonomous phase-sensitive Radio Echo Sounder</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="theory_1.html">Autonomous phase-sensitive radio-echo sounder theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="beat-frequency.html">Beat frequency</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">A first look at ApRES data</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../appendix/upload_Measures_data_to_bucket.html">Adding the MEASURES data to the google bucket</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">References</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/jkingslake/apres_jp/main?urlpath=lab/tree/src/sections/radar/apres/apres_data_1.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp/edit/main/src/sections/radar/apres/apres_data_1.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/jkingslake/apres_jp/issues/new?title=Issue%20on%20page%20%2Fsections/radar/apres/apres_data_1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/sections/radar/apres/apres_data_1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>A first look at ApRES data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-packages">Load packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">The data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-chirps">Plot the chirps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agreement-between-chirps">Agreement between chirps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-prominent-frequency">A prominent frequency</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-power">Plot the power</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking">Stacking</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#order-of-operations">Order of operations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-reveals-more-details">Stacking reveals more details</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trim-the-data">Trim the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#padding-the-data">Padding the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#roll">Roll</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-the-fft-on-the-rolled-padded-chirp">Perform the FFT on the rolled, padded chirp</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-all-these-steps-with-xapres">Performing all these steps with xapres</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-part-of-a-much-larger-dataset">Load part of a much larger dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a-first-look-at-apres-data">
<h1>A first look at ApRES data<a class="headerlink" href="#a-first-look-at-apres-data" title="Permalink to this heading">#</a></h1>
<p>Earlier in this chapter we looked at the theory behind the autonomous phase-sensitive radio-echo sounder (ApRES), developed by the British Antarctic Survey (BAS). We have seen how it is the frequency content of the signal recorded by ApRES which tells us the range to sub-surface reflectors and how to use a fourier transform to estimate this frequency content and estimate the range to reflectors.</p>
<p>Below we will load and examine ApRES data collected on Thwaites Glacier as part of the International Thwaites Glacier Collaboration (ITGC).</p>
<section id="load-packages">
<h2>Load packages<a class="headerlink" href="#load-packages" title="Permalink to this heading">#</a></h2>
<p>As well as numpy and matplotlib, we will use a package called <a class="reference external" href="https://github.com/ldeo-glaciology/xapres">xapres</a> which was developed to load and process ApRES data in python. xapres is built around xarray, a package for working with multi-dimensional arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1">#sys.path.append(&quot;/Users/jkingslake/Documents/science/ApRES/xapres/&quot;)</span>
<span class="kn">import</span> <span class="nn">xapres</span> <span class="k">as</span> <span class="nn">xa</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="the-data">
<h2>The data<a class="headerlink" href="#the-data" title="Permalink to this heading">#</a></h2>
<p>The data we will use was collected on Thwaites Glacier, West Antarctica, by Elizabeth Case as part of the GHOST overland traverse in the 2022-2023 field season. Follow up data was collected Alex Brisbourne and Sierra Melton in 2023-2024. Part of these ApRES surveys was a line of measurements taken along a profile approximately aligned with flow down the middle of the glacier.</p>
<p>As described in previous pages, ApRES data is collected in ‘chirps’, each one second in length. Generally, many chirps are recorded repeatedly at each location and together these are known as a burst.</p>
<p>At each of ~250 waypoints, Elizabeth collected a burst consisting of 100 chirps.</p>
<p>ApRES data is stored in a binary format with the file extension .dat. The xapres package has tools to load this data format.</p>
</section>
<section id="load-the-data">
<h2>Load the data<a class="headerlink" href="#load-the-data" title="Permalink to this heading">#</a></h2>
<p>The cell below creates a <code class="docutils literal notranslate"><span class="pre">from_dats</span></code> object, which will be used to load the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fd</span> <span class="o">=</span> <span class="n">xa</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">from_dats</span><span class="p">(</span><span class="n">max_range</span><span class="o">=</span><span class="mi">2500</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The Thwaites Glacier ApRES data is stored in an open google bucket. We can list and count the .dat files in the bucket as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">root_directory</span> <span class="o">=</span> <span class="s1">&#39;gs://ldeo-glaciology/apres/thwaites&#39;</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">list_files</span><span class="p">(</span><span class="n">directory</span> <span class="o">=</span> <span class="n">root_directory</span><span class="p">,</span> <span class="n">remote_load</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2301
</pre></div>
</div>
</div>
</div>
<p>There are thousands of .dat files from different seasons and different locations. We will chose a .dat file at random to load (note that most of these data are arranged so that one .dat file is in each directory, but this is not always the case, so we specify <code class="docutils literal notranslate"><span class="pre">file_numbers_to_process=[0]</span></code> to ensure we only load one file).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">directory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">filenames</span><span class="p">[</span><span class="mi">20</span><span class="p">])</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">load_all</span><span class="p">(</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span><span class="p">,</span> <span class="n">remote_load</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">file_numbers_to_process</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:          (time: 1, chirp_time: 40001, chirp_num: 100,
                      attenuator_setting_pair: 1, profile_range: 11889)
Coordinates:
  * time             (time) datetime64[ns] 2022-12-31T09:18:13
  * chirp_time       (chirp_time) float64 0.0 2.5e-05 5e-05 ... 1.0 1.0 1.0
  * profile_range    (profile_range) float64 0.0 0.2103 ... 2.5e+03 2.5e+03
  * chirp_num        (chirp_num) int64 0 1 2 3 4 5 6 7 ... 93 94 95 96 97 98 99
    filename         (time) &lt;U86 &#x27;ldeo-glaciology/apres/thwaites/2022-2023/Po...
    burst_number     (time) int64 0
    AFGain           (attenuator_setting_pair) int64 -4
    attenuator       (attenuator_setting_pair) float64 26.0
    orientation      (time) &lt;U7 &#x27;unknown&#x27;
Dimensions without coordinates: attenuator_setting_pair
Data variables:
    chirp            (time, chirp_time, chirp_num, attenuator_setting_pair) float64 ...
    profile          (time, profile_range, chirp_num, attenuator_setting_pair) complex128 ...
    latitude         (time) float64 0.0
    longitude        (time) float64 0.0
    battery_voltage  (time) float64 0.2296
    temperature_1    (time) float64 505.5
    temperature_2    (time) float64 505.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2696de4d-9d16-444b-b863-6a9ad5911faf' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2696de4d-9d16-444b-b863-6a9ad5911faf' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 1</li><li><span class='xr-has-index'>chirp_time</span>: 40001</li><li><span class='xr-has-index'>chirp_num</span>: 100</li><li><span>attenuator_setting_pair</span>: 1</li><li><span class='xr-has-index'>profile_range</span>: 11889</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-cd9f6fe5-9e24-4b43-9d87-0123a99cf7e9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-cd9f6fe5-9e24-4b43-9d87-0123a99cf7e9' class='xr-section-summary' >Coordinates: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-12-31T09:18:13</div><input id='attrs-de0aa276-e40b-4a0d-9d23-0df187d210a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de0aa276-e40b-4a0d-9d23-0df187d210a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-15759039-9c28-4a06-9036-30e66f490789' class='xr-var-data-in' type='checkbox'><label for='data-15759039-9c28-4a06-9036-30e66f490789' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time of burst</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2022-12-31T09:18:13.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chirp_time</span></div><div class='xr-var-dims'>(chirp_time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 2.5e-05 5e-05 ... 1.0 1.0 1.0</div><input id='attrs-99ed76fc-ba9b-4ee9-af9c-e0f5f604ff41' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-99ed76fc-ba9b-4ee9-af9c-e0f5f604ff41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd2f85c0-c5b8-4548-a004-e9e7dce83b6a' class='xr-var-data-in' type='checkbox'><label for='data-fd2f85c0-c5b8-4548-a004-e9e7dce83b6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time of samples during chirps</dd><dt><span>name :</span></dt><dd>time of samples during chirps</dd><dt><span>units :</span></dt><dd>seconds</dd></dl></div><div class='xr-var-data'><pre>array([0.00000e+00, 2.50000e-05, 5.00000e-05, ..., 9.99950e-01, 9.99975e-01,
       1.00000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>profile_range</span></div><div class='xr-var-dims'>(profile_range)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.2103 ... 2.5e+03 2.5e+03</div><input id='attrs-35f26064-3eb0-4014-882d-46857916b922' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-35f26064-3eb0-4014-882d-46857916b922' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26f7045d-4b83-4fcb-952d-427a9ffe0dac' class='xr-var-data-in' type='checkbox'><label for='data-26f7045d-4b83-4fcb-952d-427a9ffe0dac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>depth</dd><dt><span>units :</span></dt><dd>meters</dd></dl></div><div class='xr-var-data'><pre>array([0.000000e+00, 2.102896e-01, 4.205791e-01, ..., 2.499502e+03,
       2.499712e+03, 2.499922e+03])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chirp_num</span></div><div class='xr-var-dims'>(chirp_num)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 94 95 96 97 98 99</div><input id='attrs-6c044015-ec48-4ea9-aa52-c23ef4034852' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6c044015-ec48-4ea9-aa52-c23ef4034852' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9d0f513f-3aff-417f-aa29-9f55d8ef7502' class='xr-var-data-in' type='checkbox'><label for='data-9d0f513f-3aff-417f-aa29-9f55d8ef7502' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>chirp number</dd><dt><span>description :</span></dt><dd>the number of each chirp within each burst</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>filename</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U86</div><div class='xr-var-preview xr-preview'>&#x27;ldeo-glaciology/apres/thwaites/...</div><input id='attrs-ba52815d-dd1e-4a1e-b5f3-58b618fea8e9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ba52815d-dd1e-4a1e-b5f3-58b618fea8e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50c9e16e-16b4-4528-9147-59638b8e1f4d' class='xr-var-data-in' type='checkbox'><label for='data-50c9e16e-16b4-4528-9147-59638b8e1f4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>the name of the file that contains each burst</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;ldeo-glaciology/apres/thwaites/2022-2023/Point/G1-25-05/2022-12-31_091750_G1_25_05.dat&#x27;],
      dtype=&#x27;&lt;U86&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>burst_number</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-62422305-2200-4689-91bf-adce91821e2a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-62422305-2200-4689-91bf-adce91821e2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-efb4010a-7ec3-4d59-8f27-a4dfeadd6098' class='xr-var-data-in' type='checkbox'><label for='data-efb4010a-7ec3-4d59-8f27-a4dfeadd6098' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>the number of each burst within each file</dd></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AFGain</span></div><div class='xr-var-dims'>(attenuator_setting_pair)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-4</div><input id='attrs-499be03b-f268-41e7-b2c2-c569c8b090d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-499be03b-f268-41e7-b2c2-c569c8b090d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abf5df6e-9b58-4d09-8f9e-c5f290fed98b' class='xr-var-data-in' type='checkbox'><label for='data-abf5df6e-9b58-4d09-8f9e-c5f290fed98b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>audio-frequency gain control setting</dd><dt><span>units :</span></dt><dd>decibels</dd></dl></div><div class='xr-var-data'><pre>array([-4])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>attenuator</span></div><div class='xr-var-dims'>(attenuator_setting_pair)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.0</div><input id='attrs-329bf076-4562-46b5-8cc0-9dd31037d4da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-329bf076-4562-46b5-8cc0-9dd31037d4da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d68b2040-ce26-4ad4-bce2-6aef5b9169e2' class='xr-var-data-in' type='checkbox'><label for='data-d68b2040-ce26-4ad4-bce2-6aef5b9169e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>radio-frequency attenuator setting</dd><dt><span>units :</span></dt><dd>decibels</dd></dl></div><div class='xr-var-data'><pre>array([26.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>orientation</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;unknown&#x27;</div><input id='attrs-9df6b800-d6e3-4070-95f1-f73f963eeb2c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9df6b800-d6e3-4070-95f1-f73f963eeb2c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e9cf53d-3ed3-44fb-9b9f-cb97926d83d4' class='xr-var-data-in' type='checkbox'><label for='data-4e9cf53d-3ed3-44fb-9b9f-cb97926d83d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>HH, HV, VH, or VV antenna orientation as described in Ersahadi et al 2022 doi:10.5194/tc-16-1719-2022</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;unknown&#x27;], dtype=&#x27;&lt;U7&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-51e6e0cf-fa44-4f63-a1be-4985116fcb97' class='xr-section-summary-in' type='checkbox'  checked><label for='section-51e6e0cf-fa44-4f63-a1be-4985116fcb97' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>chirp</span></div><div class='xr-var-dims'>(time, chirp_time, chirp_num, attenuator_setting_pair)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0006866 0.04704 ... 0.913 0.9113</div><input id='attrs-7116295a-8c9b-4b50-b7d0-8278fc6c3ddc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7116295a-8c9b-4b50-b7d0-8278fc6c3ddc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d9dcbf90-b95c-4c86-b5f4-345ac439f1e1' class='xr-var-data-in' type='checkbox'><label for='data-d9dcbf90-b95c-4c86-b5f4-345ac439f1e1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>de-ramped chirp</dd><dt><span>units :</span></dt><dd>volts</dd><dt><span>description :</span></dt><dd>voltage from the analog-to-digital converter after the received signal has been mixed with the transmitted signal and the result has been filtered to leave only the low frequency compponent corresponding to the differences in the frequencies of the Tx and Rx signals</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 6.86645508e-04],
         [ 4.70352173e-02],
         [-3.73840332e-03],
         ...,
         [ 9.42230225e-03],
         [ 2.36892700e-02],
         [ 5.51605225e-02]],

        [[ 2.48718262e-02],
         [ 7.32421875e-02],
         [ 2.11334229e-02],
         ...,
         [ 3.80325317e-02],
         [ 4.21524048e-02],
         [ 7.84301758e-02]],

        [[ 1.23443604e-01],
         [ 2.06375122e-01],
         [ 1.13945007e-01],
         ...,
...
         ...,
         [ 4.46319580e-02],
         [ 5.30624390e-02],
         [ 5.40542603e-02]],

        [[ 8.31985474e-02],
         [ 8.68606567e-02],
         [ 6.67953491e-02],
         ...,
         [ 7.78198242e-02],
         [ 8.02993774e-02],
         [ 7.90023804e-02]],

        [[ 9.29603577e-01],
         [ 9.34638977e-01],
         [ 9.12284851e-01],
         ...,
         [ 9.14497375e-01],
         [ 9.12971497e-01],
         [ 9.11254883e-01]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>profile</span></div><div class='xr-var-dims'>(time, profile_range, chirp_num, attenuator_setting_pair)</div><div class='xr-var-dtype'>complex128</div><div class='xr-var-preview xr-preview'>(0.008066033999802286+0j) ... (5...</div><input id='attrs-d529f505-bb1c-477c-a7cc-dec018336775' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d529f505-bb1c-477c-a7cc-dec018336775' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cf2bc4eb-a784-474f-ba30-6eee9010fccb' class='xr-var-data-in' type='checkbox'><label for='data-cf2bc4eb-a784-474f-ba30-6eee9010fccb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>profile</dd><dt><span>units :</span></dt><dd>-</dd><dt><span>description :</span></dt><dd>complex profile computed from the fourier transform of the de-ramped chirp</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 8.06603400e-03+0.00000000e+00j],
         [ 8.07940852e-03+0.00000000e+00j],
         [ 8.08329945e-03+0.00000000e+00j],
         ...,
         [ 7.87768584e-03+0.00000000e+00j],
         [ 7.87594119e-03+0.00000000e+00j],
         [ 7.87459025e-03+0.00000000e+00j]],

        [[ 1.52107813e-06+7.10555396e-03j],
         [-5.72940525e-07+7.11666760e-03j],
         [-9.85705403e-07+7.12022005e-03j],
         ...,
         [-1.47652015e-07+6.93914621e-03j],
         [-2.68113803e-08+6.93753080e-03j],
         [ 4.27284038e-07+6.93647589e-03j]],

        [[-4.79448288e-03-2.25607073e-07j],
         [-4.80077629e-03-2.39410889e-06j],
         [-4.80349024e-03-2.95869522e-06j],
         ...,
...
         ...,
         [ 4.02697146e-06-1.22529112e-06j],
         [ 2.35110626e-06+8.10069002e-07j],
         [ 1.27965540e-08+1.23008753e-06j]],

        [[ 6.08147690e-06+1.45114390e-06j],
         [-8.08853745e-07+1.53234360e-06j],
         [ 6.71406780e-06+4.67500209e-07j],
         ...,
         [ 4.29367044e-06+1.52795793e-06j],
         [-8.53912520e-07-5.69351826e-07j],
         [ 2.74707407e-07-1.00887419e-06j]],

        [[-2.79700582e-06+6.42066038e-06j],
         [ 1.49994703e-06-8.63471267e-07j],
         [-9.18292828e-08+5.66460009e-06j],
         ...,
         [-7.20046284e-07+6.94710976e-06j],
         [ 3.57887009e-06-5.27841670e-07j],
         [ 5.16019899e-07+8.51614282e-07j]]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-ff9bfc0b-081e-48cb-9bd7-d40fc1eddb20' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ff9bfc0b-081e-48cb-9bd7-d40fc1eddb20' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-464f2866-dfce-4422-8599-33b070293f91' class='xr-var-data-in' type='checkbox'><label for='data-464f2866-dfce-4422-8599-33b070293f91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees</dd><dt><span>long_name :</span></dt><dd>latitude of burst</dd></dl></div><div class='xr-var-data'><pre>array([0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-a0887d72-c177-4a38-8f20-6b7a8ecece3e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a0887d72-c177-4a38-8f20-6b7a8ecece3e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d692dd8a-5a7c-458f-901b-41fb5049c4c7' class='xr-var-data-in' type='checkbox'><label for='data-d692dd8a-5a7c-458f-901b-41fb5049c4c7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees</dd><dt><span>long_name :</span></dt><dd>longitude of burst</dd></dl></div><div class='xr-var-data'><pre>array([0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>battery_voltage</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.2296</div><input id='attrs-e33deb00-1226-4f7a-b4e4-c670a1bf4235' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e33deb00-1226-4f7a-b4e4-c670a1bf4235' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b5b3a6ff-64f2-4263-908f-a9b52559f073' class='xr-var-data-in' type='checkbox'><label for='data-b5b3a6ff-64f2-4263-908f-a9b52559f073' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>volts</dd><dt><span>long_name :</span></dt><dd>battery voltage</dd></dl></div><div class='xr-var-data'><pre>array([0.229614])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature_1</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>505.5</div><input id='attrs-199d0260-0f81-4e37-ac26-2d8fa1a8b570' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-199d0260-0f81-4e37-ac26-2d8fa1a8b570' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0140f3b-f86e-4012-9989-6402a6b239b4' class='xr-var-data-in' type='checkbox'><label for='data-a0140f3b-f86e-4012-9989-6402a6b239b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>celsius</dd><dt><span>long_name :</span></dt><dd>temperature measured inside the ApRES unit in one location</dd></dl></div><div class='xr-var-data'><pre>array([505.477])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temperature_2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>505.0</div><input id='attrs-fee4f9ab-a89d-4e31-92f5-9e07bc44a557' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fee4f9ab-a89d-4e31-92f5-9e07bc44a557' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-950f5d31-5132-4f72-99e5-7a525ab3b4a6' class='xr-var-data-in' type='checkbox'><label for='data-950f5d31-5132-4f72-99e5-7a525ab3b4a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>celsius</dd><dt><span>long_name :</span></dt><dd>temperature measured inside the ApRES unit in a second location</dd></dl></div><div class='xr-var-data'><pre>array([504.953])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-59c4b98a-39b9-4838-94a0-530408bcc283' class='xr-section-summary-in' type='checkbox'  ><label for='section-59c4b98a-39b9-4838-94a0-530408bcc283' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-14429d85-ba67-4228-ab6b-60f87aa45fc8' class='xr-index-data-in' type='checkbox'/><label for='index-14429d85-ba67-4228-ab6b-60f87aa45fc8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2022-12-31 09:18:13&#x27;], dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>chirp_time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7f054078-dc5d-4287-9c2f-0bf3dbe07965' class='xr-index-data-in' type='checkbox'/><label for='index-7f054078-dc5d-4287-9c2f-0bf3dbe07965' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                   0.0,                2.5e-05,                  5e-05,
        7.500000000000001e-05,                 0.0001,               0.000125,
       0.00015000000000000001,               0.000175,                 0.0002,
       0.00022500000000000002,
       ...
           0.9997750000000001,                 0.9998,     0.9998250000000001,
                      0.99985,     0.9998750000000001,                 0.9999,
           0.9999250000000001,                0.99995,     0.9999750000000001,
                          1.0],
      dtype=&#x27;float64&#x27;, name=&#x27;chirp_time&#x27;, length=40001))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>profile_range</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3926cf2c-31cb-4dee-aadd-c4cba7ee1a02' class='xr-index-data-in' type='checkbox'/><label for='index-3926cf2c-31cb-4dee-aadd-c4cba7ee1a02' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([               0.0, 0.2102895577845166, 0.4205791155690332,
       0.6308686733535498, 0.8411582311380664,  1.051447788922583,
       1.2617373467070996, 1.4720269044916163, 1.6823164622761329,
       1.8926060200606494,
       ...
        2498.029656922273, 2498.2399464800574,  2498.450236037842,
       2498.6605255956265,  2498.870815153411,  2499.081104711195,
       2499.2913942689797, 2499.5016838267643,  2499.711973384549,
       2499.9222629423334],
      dtype=&#x27;float64&#x27;, name=&#x27;profile_range&#x27;, length=11889))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>chirp_num</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f1e4927d-eaa7-424b-bffb-dd76a5dccd22' class='xr-index-data-in' type='checkbox'/><label for='index-f1e4927d-eaa7-424b-bffb-dd76a5dccd22' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99],
      dtype=&#x27;int64&#x27;, name=&#x27;chirp_num&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3da66784-757d-4997-ae7b-9588ae8b6c9a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3da66784-757d-4997-ae7b-9588ae8b6c9a' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>This produced an xarray Dataset contained many variables. The only one we are interested in right now is <code class="docutils literal notranslate"><span class="pre">ds.chirp</span></code>, which is the voltage recorded by ApRES during each one-second chirp. This is the so-called deramped signal. It is the result of combining the tranmsitted chirp with the received signal. See the two previous pages for more details.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chirp</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">chirp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>    <span class="c1"># .squeeze() removes the singleton dimensions</span>
<span class="n">chirp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;chirp&#x27; (chirp_time: 40001, chirp_num: 100)&gt;
array([[ 6.86645508e-04,  4.70352173e-02, -3.73840332e-03, ...,
         9.42230225e-03,  2.36892700e-02,  5.51605225e-02],
       [ 2.48718262e-02,  7.32421875e-02,  2.11334229e-02, ...,
         3.80325317e-02,  4.21524048e-02,  7.84301758e-02],
       [ 1.23443604e-01,  2.06375122e-01,  1.13945007e-01, ...,
         1.49841309e-01,  1.29928589e-01,  1.91040039e-01],
       ...,
       [ 5.45120239e-02,  4.97055054e-02,  4.74548340e-02, ...,
         4.46319580e-02,  5.30624390e-02,  5.40542603e-02],
       [ 8.31985474e-02,  8.68606567e-02,  6.67953491e-02, ...,
         7.78198242e-02,  8.02993774e-02,  7.90023804e-02],
       [ 9.29603577e-01,  9.34638977e-01,  9.12284851e-01, ...,
         9.14497375e-01,  9.12971497e-01,  9.11254883e-01]])
Coordinates:
    time          datetime64[ns] 2022-12-31T09:18:13
  * chirp_time    (chirp_time) float64 0.0 2.5e-05 5e-05 7.5e-05 ... 1.0 1.0 1.0
  * chirp_num     (chirp_num) int64 0 1 2 3 4 5 6 7 ... 92 93 94 95 96 97 98 99
    filename      &lt;U86 &#x27;ldeo-glaciology/apres/thwaites/2022-2023/Point/G1-25-...
    burst_number  int64 0
    AFGain        int64 -4
    attenuator    float64 26.0
    orientation   &lt;U7 &#x27;unknown&#x27;
Attributes:
    long_name:    de-ramped chirp
    units:        volts
    description:  voltage from the analog-to-digital converter after the rece...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'chirp'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>chirp_time</span>: 40001</li><li><span class='xr-has-index'>chirp_num</span>: 100</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-22f122b7-6b8f-4aea-aa5d-d23ece70a865' class='xr-array-in' type='checkbox' checked><label for='section-22f122b7-6b8f-4aea-aa5d-d23ece70a865' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0006866 0.04704 -0.003738 0.006981 ... 0.9156 0.9145 0.913 0.9113</span></div><div class='xr-array-data'><pre>array([[ 6.86645508e-04,  4.70352173e-02, -3.73840332e-03, ...,
         9.42230225e-03,  2.36892700e-02,  5.51605225e-02],
       [ 2.48718262e-02,  7.32421875e-02,  2.11334229e-02, ...,
         3.80325317e-02,  4.21524048e-02,  7.84301758e-02],
       [ 1.23443604e-01,  2.06375122e-01,  1.13945007e-01, ...,
         1.49841309e-01,  1.29928589e-01,  1.91040039e-01],
       ...,
       [ 5.45120239e-02,  4.97055054e-02,  4.74548340e-02, ...,
         4.46319580e-02,  5.30624390e-02,  5.40542603e-02],
       [ 8.31985474e-02,  8.68606567e-02,  6.67953491e-02, ...,
         7.78198242e-02,  8.02993774e-02,  7.90023804e-02],
       [ 9.29603577e-01,  9.34638977e-01,  9.12284851e-01, ...,
         9.14497375e-01,  9.12971497e-01,  9.11254883e-01]])</pre></div></div></li><li class='xr-section-item'><input id='section-b1e82880-5c08-4410-b5c1-9cf44294d6b0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b1e82880-5c08-4410-b5c1-9cf44294d6b0' class='xr-section-summary' >Coordinates: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-12-31T09:18:13</div><input id='attrs-2dd51c5f-7bab-4cfe-8f53-3a78c7e7115c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2dd51c5f-7bab-4cfe-8f53-3a78c7e7115c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10cfc3bb-e7c6-4531-854d-0619be33603a' class='xr-var-data-in' type='checkbox'><label for='data-10cfc3bb-e7c6-4531-854d-0619be33603a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time of burst</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-12-31T09:18:13.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chirp_time</span></div><div class='xr-var-dims'>(chirp_time)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 2.5e-05 5e-05 ... 1.0 1.0 1.0</div><input id='attrs-6e92e442-c294-41fa-8972-9d9613c5bdb5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e92e442-c294-41fa-8972-9d9613c5bdb5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-22aa793a-c2f8-48dd-9b4b-51fe579c83ed' class='xr-var-data-in' type='checkbox'><label for='data-22aa793a-c2f8-48dd-9b4b-51fe579c83ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time of samples during chirps</dd><dt><span>name :</span></dt><dd>time of samples during chirps</dd><dt><span>units :</span></dt><dd>seconds</dd></dl></div><div class='xr-var-data'><pre>array([0.00000e+00, 2.50000e-05, 5.00000e-05, ..., 9.99950e-01, 9.99975e-01,
       1.00000e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>chirp_num</span></div><div class='xr-var-dims'>(chirp_num)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 94 95 96 97 98 99</div><input id='attrs-d9aa0aea-4066-4176-a8c4-57d8a283dea8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d9aa0aea-4066-4176-a8c4-57d8a283dea8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1d53ad7-4f09-45d0-a1fe-367c4882a79c' class='xr-var-data-in' type='checkbox'><label for='data-f1d53ad7-4f09-45d0-a1fe-367c4882a79c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>chirp number</dd><dt><span>description :</span></dt><dd>the number of each chirp within each burst</dd></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>filename</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U86</div><div class='xr-var-preview xr-preview'>&#x27;ldeo-glaciology/apres/thwaites/...</div><input id='attrs-3cf97ce7-6087-484a-963e-a8d979f85f2b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3cf97ce7-6087-484a-963e-a8d979f85f2b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-604bc32a-3683-404f-8613-b79e4f784898' class='xr-var-data-in' type='checkbox'><label for='data-604bc32a-3683-404f-8613-b79e4f784898' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>the name of the file that contains each burst</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;ldeo-glaciology/apres/thwaites/2022-2023/Point/G1-25-05/2022-12-31_091750_G1_25_05.dat&#x27;,
      dtype=&#x27;&lt;U86&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>burst_number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-bec09063-d687-4be8-9ded-d0c040bb6bbf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bec09063-d687-4be8-9ded-d0c040bb6bbf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-72896b2d-eec7-40bd-9160-b5140cc88f75' class='xr-var-data-in' type='checkbox'><label for='data-72896b2d-eec7-40bd-9160-b5140cc88f75' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>the number of each burst within each file</dd></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>AFGain</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>-4</div><input id='attrs-778b8af3-f2de-4fe5-bb6a-336dc3e989a2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-778b8af3-f2de-4fe5-bb6a-336dc3e989a2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ba5e85f-a104-41a3-89bf-e38420b7145d' class='xr-var-data-in' type='checkbox'><label for='data-6ba5e85f-a104-41a3-89bf-e38420b7145d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>audio-frequency gain control setting</dd><dt><span>units :</span></dt><dd>decibels</dd></dl></div><div class='xr-var-data'><pre>array(-4)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>attenuator</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>26.0</div><input id='attrs-4fc2dc7c-50d7-4db3-b9d8-f421b3f45d8c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4fc2dc7c-50d7-4db3-b9d8-f421b3f45d8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1aa62c97-7268-4877-9a00-be25cbaddd49' class='xr-var-data-in' type='checkbox'><label for='data-1aa62c97-7268-4877-9a00-be25cbaddd49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>radio-frequency attenuator setting</dd><dt><span>units :</span></dt><dd>decibels</dd></dl></div><div class='xr-var-data'><pre>array(26.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>orientation</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U7</div><div class='xr-var-preview xr-preview'>&#x27;unknown&#x27;</div><input id='attrs-138b863a-c53f-4aae-8e30-894062a43da8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-138b863a-c53f-4aae-8e30-894062a43da8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a514e014-476c-4b7d-930a-7d759a70c69d' class='xr-var-data-in' type='checkbox'><label for='data-a514e014-476c-4b7d-930a-7d759a70c69d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>description :</span></dt><dd>HH, HV, VH, or VV antenna orientation as described in Ersahadi et al 2022 doi:10.5194/tc-16-1719-2022</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;unknown&#x27;, dtype=&#x27;&lt;U7&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6fb9a091-3b7d-4fb2-a9e4-06b92ec08569' class='xr-section-summary-in' type='checkbox'  ><label for='section-6fb9a091-3b7d-4fb2-a9e4-06b92ec08569' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>chirp_time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-15945561-e23c-41e3-92f3-5f540d41782b' class='xr-index-data-in' type='checkbox'/><label for='index-15945561-e23c-41e3-92f3-5f540d41782b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([                   0.0,                2.5e-05,                  5e-05,
        7.500000000000001e-05,                 0.0001,               0.000125,
       0.00015000000000000001,               0.000175,                 0.0002,
       0.00022500000000000002,
       ...
           0.9997750000000001,                 0.9998,     0.9998250000000001,
                      0.99985,     0.9998750000000001,                 0.9999,
           0.9999250000000001,                0.99995,     0.9999750000000001,
                          1.0],
      dtype=&#x27;float64&#x27;, name=&#x27;chirp_time&#x27;, length=40001))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>chirp_num</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3cf44e0b-0880-4531-9373-db1dd89830ab' class='xr-index-data-in' type='checkbox'/><label for='index-3cf44e0b-0880-4531-9373-db1dd89830ab' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71,
       72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97, 98, 99],
      dtype=&#x27;int64&#x27;, name=&#x27;chirp_num&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8140eaf1-9597-4f92-9fe2-168e65986d14' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8140eaf1-9597-4f92-9fe2-168e65986d14' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>de-ramped chirp</dd><dt><span>units :</span></dt><dd>volts</dd><dt><span>description :</span></dt><dd>voltage from the analog-to-digital converter after the received signal has been mixed with the transmitted signal and the result has been filtered to leave only the low frequency compponent corresponding to the differences in the frequencies of the Tx and Rx signals</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>This is one burst of data, recorded on New Year’s Eve 2022. It is a real-valued array with two dimensions: chirp_time and chirp_num. Chirp_time is the time during each chirp. It ranges from 0 to 1 second. The sample frequency is 40,001 Hz, so the chirp_num dimension is 40,001 long. Chirp_num is the chirp number. There were 100 chirps in this burst, so the length of the chirp_num dimension is 100. In other words, <code class="docutils literal notranslate"><span class="pre">chirp</span></code> contains 100 chirps, each 40,001 elements long.</p>
</section>
<section id="plot-the-chirps">
<h2>Plot the chirps<a class="headerlink" href="#plot-the-chirps" title="Permalink to this heading">#</a></h2>
<p>Plotting one of these chirps, we get something superficially reminiscent of the synthetic chirp we generated earlier in this chapter using 10 randomly placed reflectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chirp</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">chirp_num</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;chirp_time&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;The first chirp from this burst&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/75594a167a71503ff6545c9961edfdf089e09e06f7cf5da6c6e812b3002adbcd.png" src="../../../_images/75594a167a71503ff6545c9961edfdf089e09e06f7cf5da6c6e812b3002adbcd.png" />
</div>
</div>
<p>We can also plot all 100 chirps on the same plot to see how they compare.
There are at least two way to do this. One is to plot each chirp as a line on the same plot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chirp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;chirp_time&#39;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;chirp_num&#39;</span><span class="p">,</span>  <span class="n">add_legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;All the chirps from this burst&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fd42449fb031217f646a54b6e9d0161ea6bcddb03608037cc343465572a89767.png" src="../../../_images/fd42449fb031217f646a54b6e9d0161ea6bcddb03608037cc343465572a89767.png" />
</div>
</div>
<p>another is to plot a 2D plot with chirp number on one axis and chirp time on the other:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chirp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;All the chirps from this burst&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/665ecdaf2859d4d3425ad406336282a6fcaba70ca14f013f995b7039c4fec890.png" src="../../../_images/665ecdaf2859d4d3425ad406336282a6fcaba70ca14f013f995b7039c4fec890.png" />
</div>
</div>
<p>It is evident just from looking at either of the two plots above that (1) there is a high degree of agreement between the chirps, and (2) some frequencies are particularly prominent.</p>
<section id="agreement-between-chirps">
<h3>Agreement between chirps<a class="headerlink" href="#agreement-between-chirps" title="Permalink to this heading">#</a></h3>
<p>Let’s zoom in on the line plot above to examine the agreement between chirps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">chirp</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;chirp_time&#39;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;chirp_num&#39;</span><span class="p">,</span>  <span class="n">add_legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;All the chirps from this burst&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/7fcd9fde4bd4ed69bc9d1948a8dc03de4c3787faff893b3f33eca971cbf62bf3.png" src="../../../_images/7fcd9fde4bd4ed69bc9d1948a8dc03de4c3787faff893b3f33eca971cbf62bf3.png" />
</div>
</div>
<p>At this scale its clear that the chirps are similar, particularly at long periods, but not identical.</p>
<p>More useful still is to compute the deviation from the mean chirp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_chirp</span> <span class="o">=</span> <span class="n">chirp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;chirp_num&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">chirp</span> <span class="o">-</span> <span class="n">mean_chirp</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;chirp_time&#39;</span><span class="p">,</span> <span class="n">hue</span> <span class="o">=</span> <span class="s1">&#39;chirp_num&#39;</span><span class="p">,</span> <span class="n">add_legend</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Chirps with the mean removed&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/1c779085bd705b655abcdd573d0d39ac71e717ce61645789aae32a32ed4ec077.png" src="../../../_images/1c779085bd705b655abcdd573d0d39ac71e717ce61645789aae32a32ed4ec077.png" />
</div>
</div>
<p>This highlights how the deviations are an order of magnitude smaller than the signal and relatively high frequency. This is good news, as these chirps were all recorded at the same location within a 100-second interval, so we would hope for significant agreement.</p>
</section>
<section id="a-prominent-frequency">
<h3>A prominent frequency<a class="headerlink" href="#a-prominent-frequency" title="Permalink to this heading">#</a></h3>
<p>To examine the second point above, as a very approximate estimate, you can manually count the peaks (or the horizontal lines in the lower plot). Doing this I counted around 25 peaks in the first 0.2 seconds of the chirp. This suggests a frequency of around 125 Hz.</p>
<p>From earlier in this chapter, the range <span class="math notranslate nohighlight">\(R\)</span> is related to the frequency <span class="math notranslate nohighlight">\(f_d\)</span> by</p>
<div class="math notranslate nohighlight">
\[ 
R = \frac{c}{2\sqrt\epsilon} \frac{f_d}{K},
\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the speed of light, <span class="math notranslate nohighlight">\(\epsilon\)</span> is the permittivity of the ice, and <span class="math notranslate nohighlight">\(K\)</span> is the rate of change of frequency during the chirps. This can be understood by considering that the delay in the received signal returning to the radar is the two-way travel time <span class="math notranslate nohighlight">\(\tau = 2R\frac{\sqrt\epsilon}{c}\)</span> and because <span class="math notranslate nohighlight">\(K\)</span> is constant, this delay is linearly proportional to the difference in the transmitted and received frequencies: <span class="math notranslate nohighlight">\(f_d = K\tau.\)</span> eliminating <span class="math notranslate nohighlight">\(\tau\)</span> between these two expressions gives the equation above.</p>
<p>Using this equation for <span class="math notranslate nohighlight">\(R\)</span>, a frequency of 125Hz corresponds to a range of around 53 m:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="mi">1</span>               <span class="c1"># chirp duration [s]</span>
<span class="n">f_1</span> <span class="o">=</span> <span class="mf">200e6</span>         <span class="c1"># starting frequency [Hz]</span>
<span class="n">f_2</span> <span class="o">=</span> <span class="mf">400e6</span>         <span class="c1"># ending frequency [Hz]</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">f_2</span> <span class="o">-</span> <span class="n">f_1</span>       <span class="c1"># bandwidth [Hz]</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">B</span><span class="o">/</span><span class="n">T</span>             <span class="c1"># rate of chnge of frequency [Hz/s]</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">300000000.0</span>     <span class="c1"># speed of lightin a vacuum [m/s]</span>
<span class="n">ep</span> <span class="o">=</span> <span class="mf">3.18</span>           <span class="c1"># permittivity of ice</span>

<span class="k">def</span> <span class="nf">range</span><span class="p">(</span><span class="n">frequencies</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">frequencies</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">ep</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>

<span class="nb">range</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>52.57238944612915
</pre></div>
</div>
</div>
</div>
<p>So we will know to look out for a reflector at around 53 m depth in the amplitude plot we will make next.</p>
</section>
</section>
<section id="plot-the-power">
<h2>Plot the power<a class="headerlink" href="#plot-the-power" title="Permalink to this heading">#</a></h2>
<p>As discussed, the frequency content of the chirps contains infomation on the locations of sub-surface reflectors. We can estimate this frequency content using a fourier transform, and then plot the result as a function of range to produce something similar to the time series of return strength you would record with a conventional radar system.</p>
<p>Initially we will use the same fourier transform code as we used earlier in the chapter when playing with synthetic data.</p>
<p>First let’s extract just one chirp on which to perform the fourier transform.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_one_chirp</span> <span class="o">=</span> <span class="n">chirp</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">chirp_num</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>  <span class="c1"># again, .squeeze() removes unnecessary singleton dimensions)</span>
</pre></div>
</div>
</div>
</div>
<p>Then we define a function that takes a chirp, performs an fft on it, and returns the result and the frequencies of the bins.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is very nearly identical to the code used in <a class="reference internal" href="theory_1.html#page-apres-theory"><span class="std std-ref">Autonomous phase-sensitive radio-echo sounder theory</span></a>) execpt for the addition of <code class="docutils literal notranslate"><span class="pre">,</span> <span class="pre">axis=0</span></code> in the call to <code class="docutils literal notranslate"><span class="pre">np.fft.fft</span></code>. This has no effect except to allows us to use the same function to process every chirp in one go later on.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dt</span> <span class="o">=</span> <span class="n">chirp</span><span class="o">.</span><span class="n">chirp_time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">chirp</span><span class="o">.</span><span class="n">chirp_time</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sampling_frequency</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">dt</span>   <span class="c1"># [Hz]</span>
<span class="k">def</span> <span class="nf">fft</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="n">no_of_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">no_of_samples</span>         
    <span class="n">indexes</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">no_of_samples</span><span class="p">)</span> 
    <span class="n">frequencies</span>  <span class="o">=</span> <span class="n">indexes</span> <span class="o">*</span> <span class="n">sampling_frequency</span><span class="o">/</span><span class="n">no_of_samples</span>
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">frequencies</span>
</pre></div>
</div>
</div>
</div>
<p>Next we perform the fft and plot the results. The fft returns a complex number for each frequency bin. We can start by plotting the magnitude of these complex numbers:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_one_chirp</span><span class="p">,</span> <span class="n">frequencies</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">s_one_chirp</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">S_one_chirp</span><span class="p">));</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;range, $R$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FFT of the first chirp&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/c0a49c4c7bd3dbf5831cf99e1c89fb95d849dd1f9c924baaa4a87fd7b9f380b6.png" src="../../../_images/c0a49c4c7bd3dbf5831cf99e1c89fb95d849dd1f9c924baaa4a87fd7b9f380b6.png" />
</div>
</div>
<p>It is difficult to see details in the region <span class="math notranslate nohighlight">\(R&gt;\)</span> 500 me plot above. A logarithmic scale will be useful here. In particular, radar data is often plotted on a decibel scale as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dB</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">S</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_one_chirp</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;range, $R$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FFT of one chirp&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/33a48945d2267b8c2372b8919ed2678a20f0a2537b07d9abc7e12bce14709e23.png" src="../../../_images/33a48945d2267b8c2372b8919ed2678a20f0a2537b07d9abc7e12bce14709e23.png" />
</div>
</div>
<p>Now we can see more detail. The power initially increases with range to a peak at around 50 m, then decreases steadily until around 1000 m, after which the power stays approximately uniform with range. A peak in power around 50 m is consistent with our simple estimate based on counting peaks in the chirp above. Based on past experience with similar data, we can intepret all the little spikes in power in the region between the surface (<span class="math notranslate nohighlight">\(R\)</span> = 0) and <span class="math notranslate nohighlight">\(R\)</span> = 1000 m as englacial reflectors. While where <span class="math notranslate nohighlight">\(R&gt;1000\)</span> m, any reflectors are too lower power to be detected above the noise and the power we see in that region is background noise from the environment and possibly the radar system.</p>
</section>
<section id="stacking">
<h2>Stacking<a class="headerlink" href="#stacking" title="Permalink to this heading">#</a></h2>
<p>To reduce the level of noise we can ‘stack’ the data. This involves averaging returns from multiple chirps so that the random noise tends to cancel out while the signal (reflections from sub-surface reflectors) remains.</p>
<section id="order-of-operations">
<h3>Order of operations<a class="headerlink" href="#order-of-operations" title="Permalink to this heading">#</a></h3>
<p>You can either average all the chirps and compute the fft of the result, or you can compute the fft of each chirp and average the resulting power profiles.
We will start with the simpler, former option.</p>
<p>First, we average the chirps acorss the <code class="docutils literal notranslate"><span class="pre">chirp_num</span></code> dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_stacked</span> <span class="o">=</span> <span class="n">chirp</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;chirp_num&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Then we perform the fft and plot the results as before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_stacked</span><span class="p">,</span> <span class="n">frequencies</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">s_stacked</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_stacked</span><span class="p">));</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;range, $R$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FFT of 100 chirps stacked together&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/18edcfc566af01753b3ea38521e0f875631294ab9bfe7406e1ec177689fa03dd.png" src="../../../_images/18edcfc566af01753b3ea38521e0f875631294ab9bfe7406e1ec177689fa03dd.png" />
</div>
</div>
<p>For completeness, we also perform the stacking operations in the other order.</p>
<p>We feed the whole 2D array of chirps into our fft function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_all</span> <span class="o">=</span> <span class="n">chirp</span><span class="o">.</span><span class="n">values</span>
<span class="n">S_all</span><span class="p">,</span> <span class="n">frequencies</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">s_all</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Then plot the result and verify that the two methods give the same result to within numeical precision:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dB</span><span class="p">(</span><span class="n">S_all</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_stacked</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;stacked power from computing the fft of each chirp, then averaging [dB]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;stacked power from averaging the chirps, then computing the fft [dB]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;stacked using with different order of operations&#39;</span><span class="p">);</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">S_all</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">S_stacked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/0b72a055cb3688d1d3d28ae9a68ba7da666268414043da760acd1af99bb42670.png" src="../../../_images/0b72a055cb3688d1d3d28ae9a68ba7da666268414043da760acd1af99bb42670.png" />
</div>
</div>
</section>
</section>
<section id="stacking-reveals-more-details">
<h2>Stacking reveals more details<a class="headerlink" href="#stacking-reveals-more-details" title="Permalink to this heading">#</a></h2>
<p>Comparing the single-chirp plot to the stacked plot above shows how stacking lowers the level of noise and reveals more detail at depth.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>  <span class="c1"># Top subplot spanning both columns</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>  <span class="c1"># Bottom left subplot</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>  <span class="c1"># Bottom right subplot</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_one_chirp</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;one chirp&#39;</span><span class="p">);</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_stacked</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;100 chirps stacked together&#39;</span><span class="p">);</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;range, $R$ [m]&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;FFT of 100 chirps stacked together&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;zoom in around 500 m&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;zoom in around 1200 m&#39;</span><span class="p">);</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">500</span><span class="p">,</span> <span class="mi">550</span><span class="p">])</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">1250</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/e5119be5e762fe1efbc6a4e24a1403a244f441d0c9498b290b6f42787971f55c.png" src="../../../_images/e5119be5e762fe1efbc6a4e24a1403a244f441d0c9498b290b6f42787971f55c.png" />
</div>
</div>
<p>The bottom left plot above shows a zoom in of the unstacked and stacked power profiles around <span class="math notranslate nohighlight">\(R=\)</span> 500m. At this depth the reflectors are much higher power than the noise and there is little difference between the curves. The bottom right plot above is a zoom in around <span class="math notranslate nohighlight">\(R=\)</span> 1200 m. In this region stacking significantly affects the power. This potentially allows reflectors to be detected that would not have been detected in a power profile from a single chirp.</p>
<p>This is consistent with our observation earlier that the chirps agree well at low frequencies but appeared to disagree at higher frequencies; low frequencies correspond to shallow depths (low <span class="math notranslate nohighlight">\(R\)</span>), while higher frequencies correspond to deeper depths (higher <span class="math notranslate nohighlight">\(R\)</span>).</p>
<p>One important reflector that the stacking reveals is the reflection from the bed. It is visible at around <span class="math notranslate nohighlight">\(R=\)</span> 2200m; a local peak in the power is visible in the stacked data, but not in the unstacked data. This reflection is weak compared to reflectors higher up because the radio signal is attenuated during its 4400 m journey through the ice, but incredibly it can be traced between stacked ApRES measurements taken at adjacent waypoints along the TG flowline traverse. See Elizabeth Case’s <a class="reference external" href="https://www.proquest.com/openview/0d465d08318c086bdc146f944409b360/1?pq-origsite=gscholar&amp;cbl=18750&amp;diss=y">thesis</a> for more details.</p>
</section>
<section id="preprocessing">
<h2>Preprocessing<a class="headerlink" href="#preprocessing" title="Permalink to this heading">#</a></h2>
<p>So far we have simply directly computed the FFT of the chirps.</p>
<p>Based on software developed by BAS, several preprocessing steps can be applied to ApRES data before the FFT is computed, including applying a blackman filter and padding the data with zeros to increase the number of frequency bins. This helps with abotaininga clreaer power return, revealing additional details in the data, and helps with subsequent processing steps aimed at measuring the displacement of reflectors.</p>
<section id="trim-the-data">
<h3>Trim the data<a class="headerlink" href="#trim-the-data" title="Permalink to this heading">#</a></h3>
<p>It is useful to defining two simple rounding functions for making sure the data have an even number of samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rdi</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;round down to the nearest integer and return an integer&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">rdei</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;round down to the nearest even integer and return an integerr&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next extract and trim the data to have an even number of samples</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">chirp</span><span class="o">.</span><span class="n">chirp_time</span><span class="o">.</span><span class="n">values</span>
<span class="n">N</span> <span class="o">=</span> <span class="n">rdei</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s_one_chirp</span><span class="p">))</span>
<span class="n">s_t</span> <span class="o">=</span> <span class="n">s_one_chirp</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>             <span class="c1"># t suffix stands for &#39;trimmed&#39;</span>
<span class="n">t_t</span> <span class="o">=</span> <span class="n">t</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span>                       <span class="c1"># t suffix stands for &#39;trimmed&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="filtering">
<h3>Filtering<a class="headerlink" href="#filtering" title="Permalink to this heading">#</a></h3>
<p>We filter the data using the numpy function <code class="docutils literal notranslate"><span class="pre">np.blackman</span></code> and simply multipying the data by the output of this function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_tw</span> <span class="o">=</span> <span class="n">s_t</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">blackman</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>       <span class="c1"># w suffix stands for &#39;windowed&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_t</span><span class="p">,</span> <span class="n">s_t</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;chirp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_t</span><span class="p">,</span> <span class="n">s_tw</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;windowed chirp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;trimmed and windowed chirp&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/511187e5394ab20906d1a5c45eaca64ca6f775ee00794baedb813f4b349749af.png" src="../../../_images/511187e5394ab20906d1a5c45eaca64ca6f775ee00794baedb813f4b349749af.png" />
</div>
</div>
</section>
<section id="padding-the-data">
<h3>Padding the data<a class="headerlink" href="#padding-the-data" title="Permalink to this heading">#</a></h3>
<p>Padding the data with zeros increases the frequency resolution of the resulting prower profile, simplifying later processing steps.</p>
<p>We define a pad factor, which is the factor by which we will increase the number of samples in the data. I.e. if there are initially 40,000 samples in the chirp (after trimming), and we set <code class="docutils literal notranslate"><span class="pre">pad=2</span></code>, there will be 80,000 samples in the padded chirp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pad_factor</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Numpy’s <code class="docutils literal notranslate"><span class="pre">pad</span></code> function requires the number of zeros to add to each side of the array. Considering the total number of additional elements (<code class="docutils literal notranslate"><span class="pre">N*pad_factor</span> <span class="pre">-</span> <span class="pre">N</span> </code>) and dividing this by two relates this to the pad factor as <code class="docutils literal notranslate"><span class="pre">(N*pad_factor-N)/2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_twp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">s_tw</span><span class="p">,</span> <span class="n">pad_width</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">N</span><span class="o">*</span><span class="n">pad_factor</span><span class="o">-</span><span class="n">N</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>      <span class="c1"># p suffix stands for &#39;padded&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s_twp</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;trimmed, windowed and padded chirp&#39;</span><span class="p">)</span>
<span class="nb">len</span><span class="p">(</span><span class="n">s_twp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>80000
</pre></div>
</div>
<img alt="../../../_images/0aefaa8f2bc32da2801396cd98bbcc9a586a8f8d03a4dc9343c5fad6cbc2db28.png" src="../../../_images/0aefaa8f2bc32da2801396cd98bbcc9a586a8f8d03a4dc9343c5fad6cbc2db28.png" />
</div>
</div>
</section>
<section id="roll">
<h3>Roll<a class="headerlink" href="#roll" title="Permalink to this heading">#</a></h3>
<p>Another step in the preprocessing is to rearrange the data with a roll operation as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s_twpr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">s_twp</span><span class="p">,</span> <span class="n">shift</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">pad_factor</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>   <span class="c1"># r suffix stands for &#39;rolled&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">s_twpr</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;trimmed, windowed, padded and rolled chirp&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/fb689714bf817d671940047be490f3c3cc6c8805f5badc35e80a17e810613986.png" src="../../../_images/fb689714bf817d671940047be490f3c3cc6c8805f5badc35e80a17e810613986.png" />
</div>
</div>
</section>
<section id="perform-the-fft-on-the-rolled-padded-chirp">
<h3>Perform the FFT on the rolled, padded chirp<a class="headerlink" href="#perform-the-fft-on-the-rolled-padded-chirp" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S_twpr</span><span class="p">,</span> <span class="n">frequencies</span> <span class="o">=</span> <span class="n">fft</span><span class="p">(</span><span class="n">s_twpr</span><span class="p">)</span> 
<span class="n">S_twpr</span> <span class="o">=</span> <span class="n">S_twpr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pad_factor</span><span class="p">)</span> 
<span class="n">r_twpr</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>You can see the effect of padding on the range resolution by comparing the ragne bins obtained with and without padding</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Range resolution without padding; </span><span class="si">{</span><span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> m.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Range resolution with padding: </span><span class="si">{</span><span class="n">r_twpr</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">r_twpr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> m.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Range resolution without padding; 0.4205686013539993 m.
Range resolution with padding: 0.2102895577845166 m.
</pre></div>
</div>
</div>
</div>
<p>Finally, we plot the power profiles from the preprocessed an original chirps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_one_chirp</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FFT of original chirp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_twpr</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_twpr</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FFT of trimmed, windowed, padded, rolled chirp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;range, $R$ [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;the effect of preprocessing a chirp&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/2522ccd0c9e80239916abdf330299d1734bb8d26b9d2510ad5b32385dc11f745.png" src="../../../_images/2522ccd0c9e80239916abdf330299d1734bb8d26b9d2510ad5b32385dc11f745.png" />
</div>
</div>
</section>
</section>
<section id="performing-all-these-steps-with-xapres">
<h2>Performing all these steps with xapres<a class="headerlink" href="#performing-all-these-steps-with-xapres" title="Permalink to this heading">#</a></h2>
<p>The xapres package performs all these steps on the chirps as they are loaded and saves the result into another data variable called profile. The package also adds a method called <code class="docutils literal notranslate"><span class="pre">.dB</span></code> to the xarray to simplify plotting the power profile on a decibel scale.</p>
<p>To plot the the power profiles you can use xarray’s plotting tools as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">chirp_num</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">dB</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;from xapres&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r_twpr</span><span class="p">,</span> <span class="n">dB</span><span class="p">(</span><span class="n">S_twpr</span><span class="p">),</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;FFT of trimmed, windowed, padded, rolled chirp, processed above&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;a profile loaded from xapres and a profile processed above&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x17fe36050&gt;
</pre></div>
</div>
<img alt="../../../_images/c0dc880fc268d2724596601e04131e52ceb1c375c3166db3493b77c8e6893a4d.png" src="../../../_images/c0dc880fc268d2724596601e04131e52ceb1c375c3166db3493b77c8e6893a4d.png" />
</div>
</div>
<p>The results from tha analysis above and those produced by xapres are very similar. They differ in low-power locations. The reason is explained in this <a class="reference external" href="https://github.com/ldeo-glaciology/xapres/issues/48">issue</a> in the xapres github repository. An upcoming, small correction to the xapres code will remedy this.</p>
<p>Having the results in xarray makes stacking profiles very simple:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;chirp_num&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dB</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;processed with xapres and stacked&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2500</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.0, 2500.0)
</pre></div>
</div>
<img alt="../../../_images/f73a32431eab53dfdae185157510062b590930a385f12f4297b107bda74d6b4c.png" src="../../../_images/f73a32431eab53dfdae185157510062b590930a385f12f4297b107bda74d6b4c.png" />
</div>
</div>
<p>The pre-processing, in particular the filtering, has improved the visibility of the bed in comparison to the stacked profile we plotted above.</p>
</section>
<section id="load-part-of-a-much-larger-dataset">
<h2>Load part of a much larger dataset<a class="headerlink" href="#load-part-of-a-much-larger-dataset" title="Permalink to this heading">#</a></h2>
<p>We can also use xapres to load a much larger ApRES dataset collected in Greenland. This dataset was collected in the ablation zone of the Greenland Ice Sheet by a team led by Meredith Nettles (Lamont-Doherty Earth Observatory, LDEO) and Laura Stevens (University of Oxford), including George Lu (LDEO), Stacy Larochelle (LDEO), Marianne Okal (Earthscope), Kristin Arnold (IRIS Alpine), and Josh Rines (Stanford University). The project was funded by the US National Science Foundation (project number: 2003464).</p>
<p>Three ApRES units were positioned near several supraglacial lakes that periodically drain to the bed of the ice sheet. The units collected a burst every 15 minutes for up to 18 months.</p>
<p>We have already processed this large dataset and saved the result in a google bucket (a cloud storage location that can be quickly accessed from using cloud computing, e.g. AWS, GCS).</p>
<p>We can easily load an example large dataset using xapres as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_GR</span> <span class="o">=</span> <span class="n">xa</span><span class="o">.</span><span class="n">load</span><span class="o">.</span><span class="n">load_zarr</span><span class="p">()</span>
<span class="n">ds_GR</span><span class="o">.</span><span class="n">nbytes</span><span class="o">/</span><span class="mf">1e9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>202.513838596
</pre></div>
</div>
</div>
</div>
<p>This data has only bean ‘lazily’  loaded, meaning that the data has not yet been loaded into memory (see <a class="reference external" href="https://book.cryointhecloud.com/tutorials/ARCOdata_writingZarrs.html#the-data">here</a> for more details). We will load just a few time slices as a demonstration. To load the full dataset, you could use a cloud-computing service like <a class="reference external" href="https://book.cryointhecloud.com/intro.html">cryocloud</a> and coarsen the data before plotting.</p>
<p>The line of code below selects the timeslices and attenuator setting pair we want, selects the <code class="docutils literal notranslate"><span class="pre">profile</span></code> variable, computes the mean along the <code class="docutils literal notranslate"><span class="pre">chirp_num</span></code> dimension (i.e. stacks the chirps), and then plots the result on a decibel scale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_GR</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">150</span><span class="p">),</span> <span class="n">attenuator_setting_pair</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">profile</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span> <span class="o">=</span> <span class="s1">&#39;chirp_num&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dB</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;profile_range&#39;</span><span class="p">,</span> <span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">yincrease</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/048841bcbd22f7cbd7181a19e668481eae62e578ffcdecad87ce6e54c4ffa79e.png" src="../../../_images/048841bcbd22f7cbd7181a19e668481eae62e578ffcdecad87ce6e54c4ffa79e.png" />
</div>
</div>
<p>The time slices plotted above were chosen rather arbitrarily; they span about two weeks at the start of July 2022. The bed is visible at around 1100 m depth and between the surface and 500 m englacial layers are visible across the 12 stacked profiles.</p>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>On this page we:</p>
<ul class="simple">
<li><p>loaded ApRES data collected in Antarctica and Greenland using a package called xapres,</p></li>
<li><p>examined the chirps in one burst of data from Antarctica individually and compared them to each other,</p></li>
<li><p>performed an fft on the chirps and plotted the power profile as a function of range,</p></li>
<li><p>stacked the data (i.e. computed the mean across all the chirps in a burst) and demonstrated that it doesnt matter if you stack the chirps then perform the fft, or perform the fft on each chirp and stack the results,</p></li>
<li><p>preprocessed the data to improve the visibility of the bed and englacial layers in the power profiles,</p></li>
<li><p>used the xapres package to process the Antarctic data, and</p></li>
<li><p>used the xapres package to load and plot a much larger dataset collected in Greenland.</p></li>
</ul>
<p>In later pages we will demonstrate how to copute displacement from ApRES data using the phase of the power profiles.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "jkingslake/apres_jp",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./sections/radar/apres"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="beat-frequency.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Beat frequency</p>
      </div>
    </a>
    <a class="right-next"
       href="../../appendix/upload_Measures_data_to_bucket.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Adding the MEASURES data to the google bucket</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-packages">Load packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">The data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-the-data">Load the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-chirps">Plot the chirps</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#agreement-between-chirps">Agreement between chirps</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-prominent-frequency">A prominent frequency</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-power">Plot the power</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking">Stacking</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#order-of-operations">Order of operations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stacking-reveals-more-details">Stacking reveals more details</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing">Preprocessing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#trim-the-data">Trim the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#filtering">Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#padding-the-data">Padding the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#roll">Roll</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#perform-the-fft-on-the-rolled-padded-chirp">Perform the FFT on the rolled, padded chirp</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performing-all-these-steps-with-xapres">Performing all these steps with xapres</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-part-of-a-much-larger-dataset">Load part of a much larger dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>